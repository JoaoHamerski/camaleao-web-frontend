import{n as l,G as m,F as i,L as p,s as a,u as r,aB as u,$ as c}from"./index-fae63e1f.js";import{a as d,G as f,b as y,c as x}from"./ExpensesForm-9d8c3592.js";import{d as h,e as _}from"./Expense-8b8780bc.js";import"./masks-168ccaff.js";import"./filesMixin-e7ac34d1.js";import"./filter-58b32e89.js";import"./pasteFilesMixin-1129ca11.js";import"./DailyCash-da8f8b01.js";import"./_PaginatorFragment-c01a3fe7.js";import"./PaymentExpense-9583d97d.js";import"./Via-eb0eedf9.js";import"./User-8fb57da5.js";import"./ViewerItemsCardFile-6146f446.js";import"./vue-load-image-65c59e9a.js";import"./has-1f08a56a.js";import"./SelectEntriesFind-e5d39e3c.js";import"./truncate-9ccec01d.js";import"./omit-574aa98c.js";import"./_flatRest-a6acb8a9.js";const E={apollo:{productTypes:{query:d},expenseTypes:{query:f,async result({loading:o}){if(!o){const e=await this.$helpers.getConfig("app","product_types_expense"),t=await this.$helpers.getConfig("app","employee_expense");this.$nextTick(()=>{this.formExpense.id=e,this.formEmployee.id=t})}}}},data(){return{isLoading:!1,isEditLoading:!1,isProductTypeExpenseLoading:!1,isEmployeeExpenseLoading:!1,productTypes:[],expenseTypes:[],icons:{faEdit:m},editingType:{},form:new i({name:""}),formEdit:new i({name:""}),formExpense:new i({id:""}),formEmployee:new i({id:""})}},methods:{async submitExpenseEmployee(){const{id:o}=this.formEmployee.data();this.isEmployeeExpenseLoading=!0;try{await this.$apollo.mutate({mutation:h,variables:{id:o},refetchQueries:[{query:p,variables:{name:"app",key:"employee_expense",encoded:!1}}],awaitRefetchQueries:!0}),a(this,{message:"Alterado!"})}catch(e){r(this,e)}this.isEmployeeExpenseLoading=!1},async submitExpenseOfProduct(){const{id:o}=this.formExpense.data();this.isProductTypeExpenseLoading=!0;try{await this.$apollo.mutate({mutation:_,variables:{id:o},refetchQueries:[{query:p,variables:{name:"app",key:"product_types_expense",encoded:!1}}],awaitRefetchQueries:!0}),a(this,{message:"Alterado!"})}catch(e){r(this,e)}this.isProductTypeExpenseLoading=!1},async create(){const o=this.form.data();this.isLoading=!0;try{await this.$apollo.mutate({mutation:y,variables:{input:o},refetchQueries:[d],awaitRefetchQueries:!0}),a(this,{message:"Novo tipo de produto criado!",resetForm:!0})}catch(e){r(this,e)}this.isLoading=!1},async update(){const o=this.formEdit.data();this.isEditLoading=!0;try{await this.$apollo.mutate({mutation:x,variables:{id:this.editingType.id,input:o}}),a(this,{message:"Nome do produto atualizado!"})}catch(e){r(this,e)}this.editingType="",this.isEditLoading=!1},onEditProductTypeClick(o){this.editingType=o,this.formEdit.name=o.name}}};var g=function(){var e=this,t=e._self._c;return t("div",[t("AppForm",{attrs:{form:e.formExpense,"on-submit":e.submitExpenseOfProduct}},[t("AppSimpleSelect",{attrs:{id:"expenses_product_type",name:"expenses_product_type","label-prop":"name",options:e.expenseTypes,hint:"Este campo é exibido no cadastro de despesas"},scopedSlots:e._u([{key:"append",fn:function(){return[t("AppButton",{attrs:{outlined:"",loading:e.isProductTypeExpenseLoading}},[e._v(" Aplicar ")])]},proxy:!0}]),model:{value:e.formExpense.id,callback:function(s){e.$set(e.formExpense,"id",s)},expression:"formExpense.id"}},[e._v(" Exibir o campo Produto quando o tipo de despesa selecionada for: ")])],1),t("AppForm",{attrs:{form:e.formEmployee,"on-submit":e.submitExpenseEmployee}},[t("AppSimpleSelect",{attrs:{id:"expenses_employee",name:"expenses_employee",options:e.expenseTypes,"label-prop":"name",hint:"Este campo é exibido no cadastro de despesas"},scopedSlots:e._u([{key:"append",fn:function(){return[t("AppButton",{attrs:{outlined:"",loading:e.isEmployeeExpenseLoading}},[e._v(" Aplicar ")])]},proxy:!0}]),model:{value:e.formEmployee.id,callback:function(s){e.$set(e.formEmployee,"id",s)},expression:"formEmployee.id"}},[e._v(" Exibir o campo Funcionário quando despesa selecionada for: ")])],1),t("AppForm",{attrs:{form:e.form,"on-submit":e.create}},[t("AppInput",{attrs:{id:"name",name:"name",placeholder:"Nome do tipo de produto",error:e.form.errors.get("name")},scopedSlots:e._u([{key:"append",fn:function(){return[t("AppButton",{attrs:{outlined:"",type:"submit",loading:e.isLoading}},[e._v(" Adicionar ")])]},proxy:!0}]),model:{value:e.form.name,callback:function(s){e.$set(e.form,"name",s)},expression:"form.name"}})],1),t("div",[t("ul",{staticClass:"list-group"},e._l(e.productTypes,function(s){return t("li",{key:s.id,staticClass:"list-group-item d-flex justify-content-between align-items-center"},[e.editingType.id===s.id?[t("AppForm",{staticClass:"col",attrs:{form:e.formEdit,"on-submit":e.update}},[t("div",{staticClass:"col"},[t("AppInput",{attrs:{id:"name-edit",name:"name-edit","default-margin":!1,placeholder:"Nome do tipo de produto"},scopedSlots:e._u([{key:"append",fn:function(){return[t("AppButton",{attrs:{outlined:"",type:"submit",loading:e.isEditLoading}},[e._v(" Atualizar ")])]},proxy:!0}],null,!0),model:{value:e.formEdit.name,callback:function(n){e.$set(e.formEdit,"name",n)},expression:"formEdit.name"}})],1)])]:[t("div",[e._v(e._s(s.name))]),t("AppButton",{attrs:{"btn-class":"btn-sm",icon:e.icons.faEdit,outlined:""},on:{click:function(n){return n.preventDefault(),e.onEditProductTypeClick(s)}}})]],2)}),0)])],1)},v=[],b=l(E,g,v,!1,null,null,null,null);const T=b.exports,A={components:{ProductTypes:T},props:{value:{type:Boolean,default:!1}},data(){return{icons:{faList:u,faBoxes:c}}}};var L=function(){var e=this,t=e._self._c;return t("AppModal",e._g({attrs:{id:"modalProductTypes",value:e.value,centered:""},scopedSlots:e._u([{key:"title",fn:function(){return[t("FontAwesomeIcon",{attrs:{icon:e.icons.faList,"fixed-width":""}}),e._v(" Gerenciar tipos de produtos ")]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"text-center"},[t("FontAwesomeIcon",{staticClass:"text-primary mb-4 mt-2",attrs:{size:"3x",icon:e.icons.faBoxes}})],1),t("ProductTypes"),t("div",{staticClass:"text-end mt-3"},[t("AppButton",{attrs:{color:"light","data-bs-dismiss":"modal"}},[e._v(" Fechar ")])],1)]},proxy:!0}])},e.$listeners))},k=[],w=l(A,L,k,!1,null,null,null,null);const J=w.exports;export{J as default};
