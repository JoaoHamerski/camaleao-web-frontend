import{n as r,F,m as p,s as S,u as _,z as g,G as b,p as N,b as $,i as E,T as w,b9 as M,H as A}from"./index-fae63e1f.js";import{G as v}from"./Status-e5c68e0d.js";import{G as T}from"./User-8fb57da5.js";import{a as k,b as h}from"./OrderControl-1f6a4d8d.js";import"./_PaginatorFragment-c01a3fe7.js";var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"SectorParts"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Sector"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"alias"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"SectorStatusParts"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Sector"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"text"},arguments:[],directives:[]}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"SectorUserParts"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Sector"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"users"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sectors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetSectors"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sectors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SectorParts"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"SectorStatusParts"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"SectorUserParts"},directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateSector"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SectorInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sectorCreate"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateSector"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SectorInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sectorUpdate"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SectorParts"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"SectorStatusParts"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"SectorUserParts"},directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteSector"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sectorDelete"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:680}};i.loc.source={body:`fragment SectorParts on Sector {
  id
  name
  alias
}

fragment SectorStatusParts on Sector {
  status {
    id
    text
  }
}

fragment SectorUserParts on Sector {
  users {
    id
    name
    sectors {
      id
      name
    }
  }
}

query GetSectors {
  sectors {
    ...SectorParts
    ...SectorStatusParts
    ...SectorUserParts
  }
}

mutation CreateSector($input: SectorInput!) {
  sectorCreate(input: $input) {
    id
  }
}

mutation UpdateSector($id: ID!, $input: SectorInput!) {
  sectorUpdate(id: $id, input: $input) {
    ...SectorParts
    ...SectorStatusParts
    ...SectorUserParts
  }
}

mutation DeleteSector($id: ID!) {
  sectorDelete(id: $id) {
    id
  }
}
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function m(s,e){if(s.kind==="FragmentSpread")e.add(s.name.value);else if(s.kind==="VariableDefinition"){var t=s.type;t.kind==="NamedType"&&e.add(t.name.value)}s.selectionSet&&s.selectionSet.selections.forEach(function(n){m(n,e)}),s.variableDefinitions&&s.variableDefinitions.forEach(function(n){m(n,e)}),s.definitions&&s.definitions.forEach(function(n){m(n,e)})}var f={};(function(){i.definitions.forEach(function(e){if(e.name){var t=new Set;m(e,t),f[e.name.value]=t}})})();function y(s,e){for(var t=0;t<s.definitions.length;t++){var n=s.definitions[t];if(n.name&&n.name.value==e)return n}}function l(s,e){var t={kind:s.kind,definitions:[y(s,e)]};s.hasOwnProperty("loc")&&(t.loc=s.loc);var n=f[e]||new Set,a=new Set,c=new Set;for(n.forEach(function(o){c.add(o)});c.size>0;){var D=c;c=new Set,D.forEach(function(o){if(!a.has(o)){a.add(o);var u=f[o]||new Set;u.forEach(function(x){c.add(x)})}})}return a.forEach(function(o){var u=y(s,o);u&&t.definitions.push(u)}),t}l(i,"SectorParts");l(i,"SectorStatusParts");l(i,"SectorUserParts");const d=l(i,"GetSectors"),P=l(i,"CreateSector"),U=l(i,"UpdateSector"),R=l(i,"DeleteSector"),I=3,O={apollo:{sectors:{query:d,result(){this.loadingQueries--}},status:{query:v,result(){this.loadingQueries--}},users:{query:T,result(){this.loadingQueries--}}},props:{isEdit:{type:Boolean,default:!1},sector:{type:Object,default:()=>{}}},data(){return{status:[],users:[],sectors:[],loadingQueries:I,isLoading:!1,form:new F({name:"",alias:"",users:[],status:[]})}},watch:{loadingQueries:{immediate:!0,handler(s){!s&&this.isEdit&&this.populateForm()}}},methods:{populateForm(){const s=p(this.sector.users,"id"),e=p(this.sector.status,"id");this.form.name=this.sector.name,this.form.alias=this.sector.alias,this.form.users=this.users.filter(t=>s.includes(t.id)),this.form.status=this.status.filter(t=>e.includes(t.id))},getFormattedForm(s){return s.users=s.users.map(e=>e.id),s.status=s.status.map(e=>e.id),s},async create(s){try{await this.$apollo.mutate({mutation:P,variables:{input:s},refetchQueries:[d,v,k,h],awaitRefetchQueries:!0}),S(this,{message:"Setor cadastrado!"})}catch(e){_(this,e)}},async update(s){try{await this.$apollo.mutate({mutation:U,variables:{id:this.sector.id,input:s},refetchQueries:[d,v,k,h],awaitRefetchQueries:!0}),S(this,{message:"Setor atualizado!"})}catch(e){_(this,e)}},async submit(){const s=this.getFormattedForm(this.form.data());this.isLoading=!0,this.isEdit?await this.update(s):await this.create(s),this.isLoading=!1},statusSelectLabel(s){return s.sector?`${s.text} [${s.sector.name}]`:s.text},usersSelectLabel(s){return s.name}}};var L=function(){var e=this,t=e._self._c;return t("AppForm",{attrs:{"on-submit":e.submit,form:e.form}},[t("AppLoading",{directives:[{name:"show",rawName:"v-show",value:e.loadingQueries,expression:"loadingQueries"}]}),t("AppInput",{attrs:{id:"name",name:"name",placeholder:"Digite um nome...",error:e.form.errors.get("name")},model:{value:e.form.name,callback:function(n){e.$set(e.form,"name",n)},expression:"form.name"}},[e._v(" Nome do setor na ESTEIRA DE PRODUÇÃO ")]),t("AppInput",{attrs:{id:"alias",name:"alias",placeholder:"Digite um nome...",error:e.form.errors.get("alias"),hint:"Caso deixe em branco, será o mesmo de ESTEIRA DE PRODUÇÃO"},model:{value:e.form.alias,callback:function(n){e.$set(e.form,"alias",n)},expression:"form.alias"}},[e._v(" Nome do setor no PAINEL DE PRODUTIVIDADE ")]),t("AppSelect",{attrs:{id:"status","track-by":"id",name:"status",placeholder:"Selecione os status do setor",options:e.status,"custom-label":e.statusSelectLabel,multiple:"","close-on-select":!1,error:e.form.errors.get("status")},scopedSlots:e._u([{key:"hint",fn:function(){return[t("div",[e._v("Caso o status selecionado já esteja em outro setor, ele será removido.")])]},proxy:!0}]),model:{value:e.form.status,callback:function(n){e.$set(e.form,"status",n)},expression:"form.status"}},[e._v(" Status do setor ")]),t("AppSelect",{attrs:{id:"users","track-by":"id",name:"users",placeholder:"Selecione os usuários do setor",options:e.users,"custom-label":e.usersSelectLabel,multiple:"","close-on-select":!1,error:e.form.errors.get("users")},model:{value:e.form.users,callback:function(n){e.$set(e.form,"users",n)},expression:"form.users"}},[e._v(" Usuários do setor ")]),t("div",{staticClass:"mt-4 d-flex justify-content-between"},[t("AppButton",{attrs:{loading:e.isLoading,color:"success","btn-class":"fw-bold",type:"submit"}},[e._v(" "+e._s(e.isEdit?"Atualizar":"Cadastrar")+" ")]),t("AppButton",{attrs:{color:"light","data-bs-dismiss":"modal",type:"button"}},[e._v(" Fechar ")])],1)],1)},Q=[],B=r(O,L,Q,!1,null,null,null,null);const C=B.exports,V={components:{SectorForm:C},props:{value:{type:Boolean,default:!1}},data(){return{icons:{faPlus:g}}},methods:{onSuccess(){this.$emit("success")}}};var G=function(){var e=this,t=e._self._c;return t("AppModal",e._g({attrs:{id:"sectorModal",color:"success",value:e.value,centered:""},scopedSlots:e._u([{key:"title",fn:function(){return[t("FontAwesomeIcon",{attrs:{icon:e.icons.faPlus,"fixed-width":""}}),e._v(" Cadastrar novo setor ")]},proxy:!0},{key:"body",fn:function(){return[e.value?t("SectorForm",{on:{success:e.onSuccess}}):e._e()]},proxy:!0}])},e.$listeners))},j=[],q=r(V,G,j,!1,null,null,null,null);const z=q.exports,H={components:{SectorCreateModal:z},data(){return{icons:{faPlus:g},sectorModal:!1}},methods:{onNewSectorClick(){this.sectorModal=!0},onSectorModalSuccess(){this.sectorModal=!1}}};var J=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mb-2"},[t("AppButton",{attrs:{color:"success",icon:e.icons.faPlus,"btn-class":"fw-bold"},on:{click:function(n){return n.preventDefault(),e.onNewSectorClick.apply(null,arguments)}}},[e._v(" Novo setor ")]),t("SectorCreateModal",{on:{success:e.onSectorModalSuccess},model:{value:e.sectorModal,callback:function(n){e.sectorModal=n},expression:"sectorModal"}})],1)},K=[],W=r(H,J,K,!1,null,null,null,null);const X=W.exports,Y={components:{SectorForm:C},props:{value:{type:Boolean,default:!1},sector:{type:Object,default:()=>{}}},data(){return{icons:{faEdit:b}}},methods:{onSuccess(){this.$emit("success")}}};var Z=function(){var e=this,t=e._self._c;return t("AppModal",e._g({attrs:{id:"sectorEditModal",centered:"",value:e.value},scopedSlots:e._u([{key:"title",fn:function(){return[t("FontAwesomeIcon",{attrs:{icon:e.icons.faEdit,"fixed-width":""}}),e._v(" Editar setor ")]},proxy:!0},{key:"body",fn:function(){return[e.value?t("SectorForm",{attrs:{"is-edit":!0,sector:e.sector},on:{success:e.onSuccess}}):e._e()]},proxy:!0}])},e.$listeners))},ee=[],te=r(Y,Z,ee,!1,null,null,null,null);const se=te.exports,ne={props:{value:{type:Boolean,default:!1},sector:{type:Object,default:()=>{}}},data(){return{isLoading:!1,icons:{faTrashAlt:N,faExclamationCircle:$}}},methods:{isEmpty:E,async onConfirmDeleteClick(){this.isLoading=!0;try{await this.$apollo.mutate({mutation:R,variables:{id:this.sector.id},refetchQueries:[d],awaitRefetchQueries:!0}),this.$toast.success("Setor deletado!"),this.$emit("success")}catch{this.$toast.error("Ops! Algo deu errado.")}this.isLoading=!1}}};var ae=function(){var e=this,t=e._self._c;return t("AppModal",e._g({attrs:{id:"sectorDeleteModal",color:"danger",value:e.value},scopedSlots:e._u([{key:"title",fn:function(){return[t("FontAwesomeIcon",{attrs:{icon:e.icons.faTrashAlt,"fixed-width":""}}),e._v(" Deletar setor ")]},proxy:!0},e.isEmpty(e.sector)?null:{key:"body",fn:function(){return[t("div",{staticClass:"text-center text-secondary mt-3"},[e._v(" Você está prestes a deletar o setor: ")]),t("h5",{staticClass:"text-center text-danger fw-bold my-3"},[e._v(" "+e._s(e.sector.name)+" ")]),t("div",{staticClass:"small text-secondary"},[t("FontAwesomeIcon",{attrs:{icon:e.icons.faExclamationCircle,"fixed-width":""}}),e._v(" Nenhum usuário ou status serão deletados. ")],1),e.sector.users.length?t("div",{staticClass:"mt-3"},[t("div",{staticClass:"fw-bold small"},[e._v(" Usuários relacionados: ")]),t("div",[t("ul",{staticClass:"list-group list-group-sm"},e._l(e.sector.users,function(n){return t("li",{key:n.id,staticClass:"list-group-item"},[e._v(" "+e._s(n.name)+" ")])}),0)])]):t("div",{staticClass:"fw-bold small mt-3"},[e._v(" Nenhum usuário relacionado a este setor ")]),e.sector.status.length?t("div",{staticClass:"mt-3"},[t("div",{staticClass:"fw-bold small"},[e._v(" Status relacionados: ")]),t("div",[t("ul",{staticClass:"list-group list-group-sm"},e._l(e.sector.status,function(n){return t("li",{key:n.id,staticClass:"list-group-item"},[e._v(" "+e._s(n.text)+" ")])}),0)])]):t("div",{staticClass:"fw-bold small mt-3"},[e._v(" Nenhum status relacionado a este setor ")]),t("div",{staticClass:"row mt-4"},[t("div",{staticClass:"col"},[t("AppButton",{attrs:{color:"success",block:"","btn-class":"fw-bold",loading:e.isLoading},on:{click:function(n){return n.preventDefault(),e.onConfirmDeleteClick.apply(null,arguments)}}},[e._v(" Confirmar ")])],1),t("div",{staticClass:"col"},[t("AppButton",{attrs:{color:"light",block:"",type:"button","data-bs-dismiss":"modal",disabled:e.isLoading}},[e._v(" Cancelar ")])],1)])]},proxy:!0}],null,!0)},e.$listeners))},ie=[],re=r(ne,ae,ie,!1,null,null,null,null);const oe=re.exports,le={props:{item:{type:Object,required:!0},user:{type:Object,required:!0}}};var ce=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"fw-bold small mb-2"},[e._v(" OUTROS SETORES DO USUÁRIO: ")]),e.user.sectors.length>1?t("div",{staticClass:"small text-secondary"},[e._l(e.user.sectors,function(n){return[e.item.id!==n.id?t("span",{key:n.id,staticClass:"badge bg-primary mx-1 mb-1"},[e._v(" "+e._s(n.name)+" ")]):e._e()]})],2):t("div",{staticClass:"small"},[e._v(" Nenhum setor relacionado ")])])},de=[],ue=r(le,ce,de,!1,null,null,null,null);const me=ue.exports,ve={apollo:{sectors:{query:d}},components:{Tippy:w,SectorEditModal:se,SectorDeleteModal:oe,SectorListUserTippy:me},data(){return{sectors:[],sectorDeleteModal:{value:!1,sector:{}},sectorEditModal:{value:!1,sector:{}},icons:{faUserTag:M,faEdit:b,faTrashAlt:N,faQuestionCircle:A}}},computed:{isQueryLoading(){return!!this.$apollo.queries.sectors.loading},headers(){return[{text:"Setor",value:"name"},{text:"Usuários",value:"users"},{text:"Status",value:"status"},{text:"Ações",value:"actions",align:"center"}]}},methods:{onEditSectorClick(s){this.sectorEditModal.sector=s,this.sectorEditModal.value=!0},onEditSuccess(){this.sectorEditModal.value=!1},onEditModalClose(){this.sectorEditModal.sector={}},onDeleteSectorClick(s){this.sectorDeleteModal.sector=s,this.sectorDeleteModal.value=!0},onDeleteSuccess(){this.sectorDeleteModal.value=!1},onDeleteModalClose(){this.sectorDeleteModal.sector={}}}};var fe=function(){var e=this,t=e._self._c;return t("AppCard",{attrs:{color:"camaleao"},scopedSlots:e._u([{key:"header",fn:function(){return[t("h6",{staticClass:"fw-bold mb-0"},[t("FontAwesomeIcon",{attrs:{icon:e.icons.faUserTag,"fixed-width":""}}),e._v(" Setores ")],1)]},proxy:!0},{key:"body",fn:function(){return[t("AppLoading",{directives:[{name:"show",rawName:"v-show",value:e.isQueryLoading,expression:"isQueryLoading"}]}),t("SectorEditModal",{attrs:{sector:e.sectorEditModal.sector},on:{success:e.onEditSuccess,hidden:e.onEditModalClose},model:{value:e.sectorEditModal.value,callback:function(n){e.$set(e.sectorEditModal,"value",n)},expression:"sectorEditModal.value"}}),t("SectorDeleteModal",{attrs:{sector:e.sectorDeleteModal.sector},on:{success:e.onDeleteSuccess,hidden:e.onDeleteModalClose},model:{value:e.sectorDeleteModal.value,callback:function(n){e.$set(e.sectorDeleteModal,"value",n)},expression:"sectorDeleteModal.value"}}),t("AppTable",{attrs:{headers:e.headers,items:e.sectors},scopedSlots:e._u([{key:"items.name",fn:function({item:n}){return[t("div",[e._v(e._s(n.name))]),n.alias?t("div",{staticClass:"small text-secondary"},[e._v(" "+e._s(n.alias)+" "),t("FontAwesomeIcon",{directives:[{name:"tippy",rawName:"v-tippy"}],attrs:{"fixed-width":"",icon:e.icons.faQuestionCircle,content:"Nome no Painel de Produtividade"}})],1):e._e()]}},{key:"items.users",fn:function({item:n}){return[n.users.length?t("ul",{staticClass:"list-group list-group-sm"},e._l(n.users,function(a){return t("li",{key:a.id,staticClass:"list-group-item"},[t("Tippy",{scopedSlots:e._u([{key:"trigger",fn:function(){return[t("div",[e._v(" "+e._s(a.name)+" ")])]},proxy:!0}],null,!0)},[t("SectorListUserTippy",e._b({},"SectorListUserTippy",{user:a,item:n},!1))],1)],1)}),0):t("div",{staticClass:"d-flex justify-content-center small text-secondary"},[e._v(" Nenhum usuário neste setor ")])]}},{key:"items.status",fn:function({item:n}){return[n.status.length?t("ul",{staticClass:"list-group list-group-sm"},e._l(n.status,function(a){return t("li",{key:a.id,staticClass:"list-group-item"},[e._v(" "+e._s(a.text)+" ")])}),0):t("div",{staticClass:"d-flex justify-content-center small text-secondary"},[e._v(" Nenhum status neste setor ")])]}},{key:"items.actions",fn:function({item:n}){return[t("AppButton",{staticClass:"me-2",attrs:{icon:e.icons.faEdit,outlined:"",tooltip:"Editar"},on:{click:function(a){return a.preventDefault(),e.onEditSectorClick(n)}}}),t("AppButton",{attrs:{color:"danger",icon:e.icons.faTrashAlt,outlined:"",tooltip:"Deletar"},on:{click:function(a){return a.preventDefault(),e.onDeleteSectorClick(n)}}})]}}],null,!0)})]},proxy:!0}])})},pe=[],Se=r(ve,fe,pe,!1,null,null,null,null);const _e=Se.exports,ke={metaInfo(){return{title:"Setores"}},components:{TheSectorsHeader:X,TheSectorsBody:_e}};var he=function(){var e=this,t=e._self._c;return t("div",{staticClass:"py-5"},[t("TheSectorsHeader"),t("TheSectorsBody")],1)},ye=[],ge=r(ke,he,ye,!1,null,null,null,null);const Fe=ge.exports;export{Fe as default};
