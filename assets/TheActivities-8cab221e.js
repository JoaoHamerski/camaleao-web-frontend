import{d as _}from"./ActivityFragments-a3df58d3.js";import{n as c,T as g,b as y,c as h,F as b,d as C,D as S,m as A,i as m}from"./index-4e05606f.js";import{A as F}from"./ActivityItem-f32937c4.js";import{m as N}from"./masks-168ccaff.js";import{G as x}from"./User-8fb57da5.js";import{f as w}from"./filter-bdbeaf8b.js";var o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activities"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"page"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"orderBy"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"QueryActivitiesOrderByOrderByClause"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"where"}},type:{kind:"NamedType",name:{kind:"Name",value:"QueryActivitiesWhereWhereConditions"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activities"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"page"},value:{kind:"Variable",name:{kind:"Name",value:"page"}}},{kind:"Argument",name:{kind:"Name",value:"orderBy"},value:{kind:"Variable",name:{kind:"Name",value:"orderBy"}}},{kind:"Argument",name:{kind:"Name",value:"where"},value:{kind:"Variable",name:{kind:"Name",value:"where"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paginatorInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"total"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"perPage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"currentPage"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"log_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"OrderSubject"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"ClientSubject"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"causer"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"UserCauser"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"properties"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:546}};o.loc.source={body:`#import "./ActivityFragments.gql"

query activities (
  $first: Int!
  $page: Int
  $orderBy: [QueryActivitiesOrderByOrderByClause!]
  $where: QueryActivitiesWhereWhereConditions
) {
  activities (first: $first page: $page orderBy: $orderBy where: $where) {
    paginatorInfo {
      total
      perPage
      currentPage
    }

    data {
      id
      log_name
      description
      subject {
        ...OrderSubject
        ...ClientSubject
      }
      causer {
        ...UserCauser
      }
      properties
      created_at
    }
  }
}
`,name:"GraphQL request",locationOffset:{line:1,column:1}};var v={};function T(t){return t.filter(function(e){if(e.kind!=="FragmentDefinition")return!0;var i=e.name.value;return v[i]?!1:(v[i]=!0,!0)})}o.definitions=o.definitions.concat(T(_.definitions));function d(t,e){if(t.kind==="FragmentSpread")e.add(t.name.value);else if(t.kind==="VariableDefinition"){var i=t.type;i.kind==="NamedType"&&e.add(i.name.value)}t.selectionSet&&t.selectionSet.selections.forEach(function(a){d(a,e)}),t.variableDefinitions&&t.variableDefinitions.forEach(function(a){d(a,e)}),t.definitions&&t.definitions.forEach(function(a){d(a,e)})}var u={};(function(){o.definitions.forEach(function(e){if(e.name){var i=new Set;d(e,i),u[e.name.value]=i}})})();function p(t,e){for(var i=0;i<t.definitions.length;i++){var a=t.definitions[i];if(a.name&&a.name.value==e)return a}}function E(t,e){var i={kind:t.kind,definitions:[p(t,e)]};t.hasOwnProperty("loc")&&(i.loc=t.loc);var a=u[e]||new Set,r=new Set,s=new Set;for(a.forEach(function(n){s.add(n)});s.size>0;){var f=s;s=new Set,f.forEach(function(n){if(!r.has(n)){r.add(n);var l=u[n]||new Set;l.forEach(function(k){s.add(k)})}})}return r.forEach(function(n){var l=p(t,n);l&&i.definitions.push(l)}),i}const $=E(o,"activities"),D={components:{Tippy:g},data(){return{icons:{faExclamationCircle:y}}}};var L=function(){var e=this,i=e._self._c;return i("div",[i("Tippy",{attrs:{theme:"no-padding light-border",for:"activities-legend-icon",placement:"left"}},[i("ul",{staticClass:"list-group list-group-sm text-start"},[i("li",{staticClass:"list-group-item"},[i("b",{staticClass:"text-success"},[e._v("Ícone verde: ")]),e._v("Atividade de criação ")]),i("li",{staticClass:"list-group-item"},[i("b",{staticClass:"text-primary"},[e._v("Ícone azul: ")]),e._v("Atividade de alteração ")]),i("li",{staticClass:"list-group-item"},[i("b",{staticClass:"text-danger"},[e._v("Ícone vermelho: ")]),e._v("Atividade de exclusão ")])])]),i("FontAwesomeIcon",{attrs:{name:"activities-legend-icon",icon:e.icons.faExclamationCircle}})],1)},B=[],I=c(D,L,B,!1,null,null,null,null);const P=I.exports,R={components:{ActivityItem:F,ActivitiesLegendIcon:P},props:{activities:{type:Array,default:()=>[]},isLoading:{type:Boolean,default:!1}},data(){return{icons:{faListAlt:h}}}};var j=function(){var e=this,i=e._self._c;return i("AppCard",{staticClass:"position-relative",scopedSlots:e._u([{key:"header",fn:function(){return[i("div",{staticClass:"d-flex justify-content-between align-items-center"},[i("h6",{staticClass:"fw-bold mb-0"},[i("FontAwesomeIcon",{attrs:{icon:e.icons.faListAlt,"fixed-width":""}}),e._v(" Atividades do sistema ")],1),i("ActivitiesLegendIcon")],1)]},proxy:!0},{key:"body",fn:function(){return[i("AppLoading",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}]}),e.activities.length?[i("ul",{staticClass:"list-group list-group-flush"},e._l(e.activities,function(a){return i("ActivityItem",{key:a.id,attrs:{item:a}})}),1)]:[i("div",{staticClass:"text-center text-secondary my-5"},[e._v(" Nenhum registro encontrado ")])]]},proxy:!0}])})},V=[],Q=c(R,j,V,!1,null,null,null,null);const O=Q.exports,U=[{text:"Clientes",value:"Client"},{text:"Pedidos",value:"Order"},{text:"Pagamentos",value:"Payment"},{text:"Despesas",value:"Expense"},{text:"Cidades",value:"City"},{text:"Filiais",value:"Branch"},{text:"Transportadoras",value:"ShippingCompany"},{text:"Tipos de Roupas",value:"ClothingType"},{text:"Anotações",value:"Note"},{text:"Usuários",value:"User"}],q={props:{isLoading:{type:Boolean,default:!1}},apollo:{users:{query:x}},data(){return{maskDate:N,SUBJECT_TYPES:U,users:[],form:new b({causer_id:"",subject_type:"",date:""}),icons:{faFilter:C}}},methods:{onSubmit(){const t=this.form.data();this.$emit("filtered",t)},onClearFilterClick(){this.form.reset(),this.$emit("clear")}}};var M=function(){var e=this,i=e._self._c;return i("AppCard",{attrs:{color:"success",collapsible:""},scopedSlots:e._u([{key:"header",fn:function(){return[i("h6",{staticClass:"fw-bold mb-0"},[i("FontAwesomeIcon",{attrs:{icon:e.icons.faFilter,"fixed-width":""}}),e._v(" Filtrar atividades ")],1)]},proxy:!0},{key:"body",fn:function(){return[i("AppForm",{attrs:{form:e.form,"on-submit":e.onSubmit}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-12 col-sm"},[i("AppSimpleSelect",{attrs:{id:"causer_id",name:"causer_id",placeholder:"Selecione um usuário",options:e.users,"label-prop":"name","value-prop":"id"},model:{value:e.form.causer_id,callback:function(a){e.$set(e.form,"causer_id",a)},expression:"form.causer_id"}},[e._v(" Usuário: ")])],1),i("div",{staticClass:"col-12 col-sm"},[i("AppSimpleSelect",{attrs:{id:"subject_type",name:"subject_type",placeholder:"Selecione uma entidade",options:e.SUBJECT_TYPES,"label-prop":"text","value-prop":"value"},model:{value:e.form.subject_type,callback:function(a){e.$set(e.form,"subject_type",a)},expression:"form.subject_type"}},[e._v(" Atividades em: ")])],1)]),i("div",[i("AppInput",{attrs:{id:"date",name:"date",type:"date",placeholder:"Digite uma data...",mask:e.maskDate,numeric:""},model:{value:e.form.date,callback:function(a){e.$set(e.form,"date",a)},expression:"form.date"}},[e._v(" Data: ")])],1),i("div",[i("AppButton",{staticClass:"me-2",attrs:{color:"success","btn-class":"fw-bold",loading:e.isLoading}},[e._v(" Filtrar ")]),i("AppButton",{attrs:{type:"button",color:"light",disabled:e.isLoading},on:{click:function(a){return a.preventDefault(),e.onClearFilterClick.apply(null,arguments)}}},[e._v(" Limpar filtros ")])],1)])]},proxy:!0}])})},W=[],Y=c(q,M,W,!1,null,null,null,null);const z=Y.exports,G=[{prop:"causer_id",column:"CAUSER_ID",operator:"EQ"},{prop:"subject_type",column:"SUBJECT_TYPE",operator:"EQ"},{prop:"date",column:"CREATED_AT",operator:"EQ"}],J={components:{TheActivitiesCard:O,TheActivitiesFilter:z},metaInfo:{title(){return"Atividades do sistema"}},apollo:{activities:{query:$,variables(){return{first:10,page:this.page,orderBy:[{column:"CREATED_AT",order:"DESC"}],where:this.where}},fetchPolicy:"cache-and-network",deep:!0}},data(){return{page:1,where:{},activities:{data:[],paginatorInfo:{}}}},computed:{isLoading(){return!!this.$apollo.queries.activities.loading}},methods:{getValueFromParam(t,e){return e==="subject_type"?`App\\Models\\${t[e]}`:e==="date"?S.fromFormat(t[e],"dd/MM/y").toSQL():t[e]},getAllFilterQueries(t,e){return A(t,({prop:i,column:a,operator:r})=>({column:a,operator:r,value:this.getValueFromParam(e,i)}))},onFilter(t){const e=w(G,i=>!m(t[i.prop]));if(this.page=1,m(e)){this.where={};return}this.where={AND:this.getAllFilterQueries(e,t)}},clearFilter(){this.page=1,this.where={}}}};var H=function(){var e=this,i=e._self._c;return i("div",{staticClass:"col col-sm-10 mx-auto py-5"},[i("TheActivitiesFilter",{staticClass:"mb-2",attrs:{"is-loading":e.isLoading},on:{filtered:e.onFilter,clear:e.clearFilter}}),i("TheActivitiesCard",{attrs:{activities:e.activities.data,"is-loading":e.isLoading}}),i("AppPaginator",{staticClass:"mt-2",attrs:{pagination:e.activities.paginatorInfo,loading:e.isLoading},model:{value:e.page,callback:function(a){e.page=a},expression:"page"}})],1)},K=[],X=c(J,H,K,!1,null,null,null,null);const re=X.exports;export{re as default};
