import{G as m,a as f}from"./Expense-8b8780bc.js";import{n,az as _,F as x,u as h,G as c,i as E,r as y,a7 as v,a8 as g,a5 as i,a2 as u,aA as C,aB as b,aC as k,A as l,J as p,aD as d,p as w,aE as R,aF as T,a4 as o,b as A,aa as $,z as D,ar as F,U as I}from"./index-4e05606f.js";import{m as V}from"./masks-168ccaff.js";import{E as S}from"./ExpensesForm-277188ad.js";import{P}from"./PaymentExpenseStatus-b4702367.js";import{M as L}from"./ModalExpensesNew-9f0658f5.js";import"./_PaginatorFragment-c01a3fe7.js";import"./filesMixin-04d56c50.js";import"./filter-bdbeaf8b.js";import"./pasteFilesMixin-1129ca11.js";import"./DailyCash-da8f8b01.js";import"./PaymentExpense-9583d97d.js";import"./Via-eb0eedf9.js";import"./User-8fb57da5.js";import"./ViewerItemsCardFile-0d33846c.js";import"./vue-load-image-d69823bb.js";import"./has-81565ca3.js";import"./SelectEntriesFind-d5313c57.js";import"./truncate-000a7a5d.js";import"./omit-49c12860.js";const B={data(){return{isLoading:!1,icons:{faClipboardList:_},modal:{value:!1,src:""},form:new x({start_date:"",final_date:""}),hasDateInterval:!1,maskDate:V}},methods:{async generateReport(){const t=this.form.data();this.isLoading=!0;try{const{data:e}=await this.$apollo.query({query:m,variables:{start_date:t.start_date,final_date:t.final_date},fetchPolicy:"network-only"});this.$emit("report-generated",e.expensesReport)}catch(e){h(this,e)}this.isLoading=!1}}};var M=function(){var e=this,s=e._self._c;return s("div",[s("AppCard",{attrs:{collapsible:"",color:"success"},scopedSlots:e._u([{key:"header",fn:function(){return[s("h6",{staticClass:"fw-bold mb-0"},[s("FontAwesomeIcon",{attrs:{icon:e.icons.faClipboardList,"fixed-width":""}}),e._v(" Relatório ")],1)]},proxy:!0},{key:"body",fn:function(){return[s("AppForm",{attrs:{form:e.form,"on-submit":e.generateReport}},[s("div",{staticClass:"row"},[s("div",{staticClass:"form-label fw-bold"},[e._v(" "+e._s(e.hasDateInterval?"Datas":"Data")+" ")]),s("div",{staticClass:"col"},[s("AppInput",{attrs:{name:"start_date",placeholder:"dd/mm/aaaa",type:"date",numeric:"",mask:e.maskDate,error:e.form.errors.get("start_date")},model:{value:e.form.start_date,callback:function(a){e.$set(e.form,"start_date",a)},expression:"form.start_date"}})],1),e.hasDateInterval?s("div",{staticClass:"col"},[s("AppInput",{attrs:{name:"final_date",placeholder:"dd/mm/aaaa",type:"date",numeric:"",mask:e.maskDate,error:e.form.errors.get("final_date")},model:{value:e.form.final_date,callback:function(a){e.$set(e.form,"final_date",a)},expression:"form.final_date"}})],1):e._e()]),s("AppCheckbox",{attrs:{id:"betweenDates"},model:{value:e.hasDateInterval,callback:function(a){e.hasDateInterval=a},expression:"hasDateInterval"}},[e._v(" Por intervalo de datas ")]),s("AppButton",{attrs:{outlined:"",loading:e.isLoading},on:{click:function(a){return a.preventDefault(),e.generateReport.apply(null,arguments)}}},[e._v(" Gerar relatório ")])],1)]},proxy:!0}])})],1)},O=[],G=n(B,M,O,!1,null,null,null,null);const N=G.exports,q={components:{ExpensesForm:S},props:{value:{type:Boolean,default:!1},expense:{type:Object,default:()=>({})},expenseTypes:{type:Array,default:()=>[]},vias:{type:Array,default:()=>[]}},data(){return{expenseToEdit:{},icons:{faEdit:c}}},methods:{isEmpty:E,formatExpenseToEdit(){var e,s;const t=this.expense;this.expenseToEdit={id:t.id,description:t.description,expense_type_id:t.type.id,value:y(t.value),expense_via_id:t.via.id,product_type_id:((e=t==null?void 0:t.product_type)==null?void 0:e.id)||"",employee_id:((s=t==null?void 0:t.employee)==null?void 0:s.id)||"",receipt_path:t.receipt_path,date:t.date}},onModalHidden(){this.expenseToEdit={}},onEditSuccess(){this.$emit("success")}}};var H=function(){var e=this,s=e._self._c;return s("AppModal",e._g({attrs:{id:"modalExpenseEdit",value:e.value},on:{show:e.formatExpenseToEdit,hidden:e.onModalHidden},scopedSlots:e._u([{key:"title",fn:function(){return[s("FontAwesomeIcon",{attrs:{icon:e.icons.faEdit,"fixed-width":""}}),e._v(" Editar despesa ")]},proxy:!0},{key:"body",fn:function(){return[e.isEmpty(e.expenseToEdit)?e._e():s("ExpensesForm",{key:"registerForm",attrs:{"is-edit":!0,vias:e.vias,expense:e.expenseToEdit,"expense-types":e.expenseTypes},on:{success:e.onEditSuccess}})]},proxy:!0}])},e.$listeners))},U=[],j=n(q,H,U,!1,null,null,null,null);const z=j.exports,J={components:{PaymentExpenseStatus:P},props:{expense:{type:Object,required:!0}}};var W=function(){var e=this,s=e._self._c;return s("PaymentExpenseStatus",{attrs:{entry:e.expense,"is-expense":!0}})},K=[],Q=n(J,W,K,!1,null,null,null,null);const X=Q.exports;v.use(g);const Y={components:{ExpenseState:X},props:{isLoading:{type:Boolean,default:!1},items:{type:Array,default:()=>[]}},data(){return{expenseEmployee:null,expenseProductType:null,roles:i,icons:{faFunnelDollar:u,faEdit:c,faFilePdf:C,faFile:b,faFileImage:k,faCheck:l,faTimes:p,faMinus:d,faTrashAlt:w,faUserTie:R,faBox:T}}},computed:{headers(){return[{text:"DESCRIÇÃO",value:"description",wrap:!0},{text:"TIPO",value:"type.name"},{text:"VIA",value:"via.name"},{text:"VALOR",value:"value",format:"currencyBRL"},{text:"DATA",value:"date",format:"datetime"},{text:"COMPROVANTE",value:"receipt",align:"center"},{text:"STATUS",value:"status",align:"center"},{text:"AÇÕES",value:"actions",align:"center"}]}},methods:{onReceiptClick(t){this.$emit("view-receipt",t)},onEditButtonClick(t){this.$emit("edit",t)},onDeleteButtonClick(t){this.$emit("delete",t)},getStatusIcon(t){return t.is_confirmed===!0?l:t.is_confirmed===!1?p:d},getReceiptIcon(t){return this.$helpers.strContainsAny(t.receipt_path,".pdf")?this.icons.faFilePdf:t.receipt_path?this.icons.faFileImage:this.icons.faFile},isEditEnabled(t){return!!(t.is_confirmed===null||t.is_confirmed===!0&&this.$helpers.canView(i.GERENCIA))},hasRelatedType(t){return!!t.product_type||!!t.employee}}};var Z=function(){var e=this,s=e._self._c;return s("AppCard",{staticClass:"mb-2",attrs:{color:"primary"},scopedSlots:e._u([{key:"header",fn:function(){return[s("h6",{staticClass:"fw-bold mb-0"},[s("FontAwesomeIcon",{attrs:{icon:e.icons.faFunnelDollar,"fixed-width":""}}),e._v(" Despesas ")],1)]},proxy:!0},{key:"body",fn:function(){return[s("AppLoading",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}]}),s("AppTable",{attrs:{headers:e.headers,items:e.items},scopedSlots:e._u([{key:"table-row.item",fn:function({item:a}){return[e.hasRelatedType(a)?s("tr",{staticClass:"small border-bottom-2"},[s("td",{staticClass:"py-0",attrs:{colspan:e.headers.length}},[a.product_type?s("b",[s("FontAwesomeIcon",{attrs:{icon:e.icons.faBox,"fixed-width":""}}),e._v(" "+e._s(a.product_type.name)+" ")],1):e._e(),a.employee?s("b",[s("FontAwesomeIcon",{attrs:{icon:e.icons.faUserTie,"fixed-width":""}}),e._v(" "+e._s(a.employee.name)+" ")],1):e._e()])]):e._e()]}},{key:"items.receipt",fn:function({item:a}){return[s("AppButton",{attrs:{color:a.receipt_path?"primary":"secondary","btn-class":"btn-sm px-3",icon:e.getReceiptIcon(a),outlined:"",tooltip:a.receipt_path?"Ver":"Sem comprovante",disabled:!a.receipt_path},on:{click:function(r){return e.onReceiptClick(a)}}})]}},{key:"items.actions",fn:function({item:a}){return[s("AppButton",{staticClass:"me-2",attrs:{disabled:!e.isEditEnabled(a),color:e.isEditEnabled(a)?"primary":"secondary",tooltip:e.isEditEnabled(a)?"Editar":"Não é possível editar","btn-class":"btn-sm px-3",icon:e.icons.faEdit,outlined:""},on:{click:function(r){return r.preventDefault(),e.onEditButtonClick(a)}}}),e.$helpers.canView(e.roles.GERENCIA)?s("AppButton",{staticClass:"ms-1",attrs:{color:"danger",outlined:"",icon:e.icons.faTrashAlt,"btn-class":"btn-sm px-3",tooltip:"Excluir"},on:{click:function(r){return r.preventDefault(),e.onDeleteButtonClick(a)}}}):e._e()]}},{key:"items.status",fn:function({item:a}){return[s("ExpenseState",{attrs:{expense:a}})]}}],null,!0)})]},proxy:!0}])})},ee=[],se=n(Y,Z,ee,!1,null,null,null,null);const te=se.exports,ae={components:{ModalExpensesEdit:z,TheExpensesBodyCardTable:te,ExpensesTypesOverview:()=>o(()=>import("./ExpensesTypesOverview-04084823.js"),["assets/ExpensesTypesOverview-04084823.js","assets/index-4e05606f.js","assets/index-1259f392.css","assets/Expense-8b8780bc.js","assets/_PaginatorFragment-c01a3fe7.js","assets/ExpensesForm-277188ad.js","assets/masks-168ccaff.js","assets/filesMixin-04d56c50.js","assets/filter-bdbeaf8b.js","assets/pasteFilesMixin-1129ca11.js","assets/DailyCash-da8f8b01.js","assets/PaymentExpense-9583d97d.js","assets/Via-eb0eedf9.js","assets/User-8fb57da5.js","assets/ViewerItemsCardFile-0d33846c.js","assets/vue-load-image-d69823bb.js","assets/has-81565ca3.js","assets/SelectEntriesFind-d5313c57.js","assets/truncate-000a7a5d.js","assets/omit-49c12860.js"]),ViewerFileModal:()=>o(()=>import("./index-4e05606f.js").then(t=>t.bW),["assets/index-4e05606f.js","assets/index-1259f392.css"]),PaymentExpenseDeleteModal:()=>o(()=>import("./PaymentExpenseDeleteModal-aad496aa.js"),["assets/PaymentExpenseDeleteModal-aad496aa.js","assets/index-4e05606f.js","assets/index-1259f392.css","assets/Payment-7f758fb7.js","assets/_PaginatorFragment-c01a3fe7.js","assets/Expense-8b8780bc.js","assets/Order-ebd7beca.js","assets/ActivityFragments-a3df58d3.js"])},props:{expenses:{type:Array,default:()=>[]},pagination:{type:Object,default:()=>({})},page:{type:Number,required:!0},isLoading:{type:Boolean,default:!1}},data(){return{roles:i,icons:{faExclamationCircle:A,faFunnelDollar:u},expenseTypes:[],modalFileViewer:{src:"",modal:!1},modalExpensesDelete:{expense:{},modal:!1},modalExpensesEdit:{expense:{},modal:!1}}},methods:{onViewReceipt(t){const e=t.receipt_path;if(this.$helpers.strContainsAny(e,".pdf")){this.modalFileViewer.src=e,this.modalFileViewer.modal=!0;return}this.$viewerApi({images:[t.receipt_path],options:$})},onEdit(t){this.modalExpensesEdit.expense=t,this.modalExpensesEdit.modal=!0},onDelete(t){this.modalExpensesDelete.expense=t,this.modalExpensesDelete.modal=!0},onViewerFileModalHidden(){this.modalFileViewer.src=""},onSuccessEdit(){this.modalExpensesEdit.modal=!1,this.$emit("refresh-expenses")},onSuccessDelete(){this.modalExpensesDelete.modal=!1}}};var ne=function(){var e=this,s=e._self._c;return s("div",[s("ModalExpensesEdit",{attrs:{expense:e.modalExpensesEdit.expense},on:{success:e.onSuccessEdit},model:{value:e.modalExpensesEdit.modal,callback:function(a){e.$set(e.modalExpensesEdit,"modal",a)},expression:"modalExpensesEdit.modal"}}),s("PaymentExpenseDeleteModal",{attrs:{entry:e.modalExpensesDelete.expense,"is-expense":""},on:{success:e.onSuccessDelete},model:{value:e.modalExpensesDelete.modal,callback:function(a){e.$set(e.modalExpensesDelete,"modal",a)},expression:"modalExpensesDelete.modal"}}),s("ViewerFileModal",{attrs:{src:e.modalFileViewer.src,"modal-dialog-class":"modal-fullscreen"},on:{hidden:e.onViewerFileModalHidden},model:{value:e.modalFileViewer.modal,callback:function(a){e.$set(e.modalFileViewer,"modal",a)},expression:"modalFileViewer.modal"}}),s("AppContainer",{staticClass:"mb-3",attrs:{collapsible:"",color:"danger"},scopedSlots:e._u([{key:"title",fn:function(){return[s("FontAwesomeIcon",{attrs:{icon:e.icons.faFunnelDollar,"fixed-width":""}}),e._v(" Despesas por categoria ")]},proxy:!0},{key:"body",fn:function(){return[e.$helpers.canView(e.roles.GERENCIA)?s("ExpensesTypesOverview",{staticClass:"my-3"}):e._e()]},proxy:!0}])}),s("div",{staticClass:"text-secondary small"},[s("FontAwesomeIcon",{attrs:{icon:e.icons.faExclamationCircle,"fixed-width":""}}),e.$helpers.canView(e.roles.GERENCIA)?s("span",[e._v(" Exibindo despesas registradas por todos usuários. ")]):s("span",[e._v(" Exibindo apenas despesas registradas por você. ")])],1),s("TheExpensesBodyCardTable",{attrs:{items:e.expenses,"is-loading":e.isLoading},on:{edit:e.onEdit,delete:e.onDelete,"view-receipt":e.onViewReceipt}}),s("AppPaginator",{attrs:{"is-loading":e.isLoading,value:e.page,pagination:e.pagination},on:{input:function(a){return e.$emit("update:page",a)}}})],1)},oe=[],re=n(ae,ne,oe,!1,null,null,null,null);const ie=re.exports,le={components:{ModalExpensesNew:L,ModalExpensesTypes:()=>o(()=>import("./ModalExpensesTypes-3d5992b4.js"),["assets/ModalExpensesTypes-3d5992b4.js","assets/index-4e05606f.js","assets/index-1259f392.css","assets/ExpensesForm-277188ad.js","assets/masks-168ccaff.js","assets/filesMixin-04d56c50.js","assets/filter-bdbeaf8b.js","assets/pasteFilesMixin-1129ca11.js","assets/Expense-8b8780bc.js","assets/_PaginatorFragment-c01a3fe7.js","assets/DailyCash-da8f8b01.js","assets/PaymentExpense-9583d97d.js","assets/Via-eb0eedf9.js","assets/User-8fb57da5.js","assets/ViewerItemsCardFile-0d33846c.js","assets/vue-load-image-d69823bb.js","assets/has-81565ca3.js","assets/SelectEntriesFind-d5313c57.js","assets/truncate-000a7a5d.js","assets/omit-49c12860.js"]),ModalProductTypes:()=>o(()=>import("./ModalProductTypes-4988068c.js"),["assets/ModalProductTypes-4988068c.js","assets/index-4e05606f.js","assets/index-1259f392.css","assets/ExpensesForm-277188ad.js","assets/masks-168ccaff.js","assets/filesMixin-04d56c50.js","assets/filter-bdbeaf8b.js","assets/pasteFilesMixin-1129ca11.js","assets/Expense-8b8780bc.js","assets/_PaginatorFragment-c01a3fe7.js","assets/DailyCash-da8f8b01.js","assets/PaymentExpense-9583d97d.js","assets/Via-eb0eedf9.js","assets/User-8fb57da5.js","assets/ViewerItemsCardFile-0d33846c.js","assets/vue-load-image-d69823bb.js","assets/has-81565ca3.js","assets/SelectEntriesFind-d5313c57.js","assets/truncate-000a7a5d.js","assets/omit-49c12860.js"])},props:{expenses:{type:Array,default:()=>[]},vias:{type:Array,default:()=>[]},expenseTypes:{type:Array,default:()=>[]}},data(){return{roles:i,icons:{faPlus:D,faList:F,faSearch:I},search:"",modalExpensesRegister:!1,modalExpensesTypes:!1,modalProductTypes:!1}},methods:{onSearchClick(){this.$emit("search",this.search)},onSearchClear(){this.search="",this.$emit("search","")},onRegisterExpenseClick(){this.modalExpensesRegister=!0},onExpensesTypesClick(){this.modalExpensesTypes=!0},onExpenseRegisterSuccess(){this.modalExpensesRegister=!1},onProductTypesClick(){this.modalProductTypes=!0}}};var pe=function(){var e=this,s=e._self._c;return s("div",[s("ModalExpensesNew",{on:{success:e.onExpenseRegisterSuccess},model:{value:e.modalExpensesRegister,callback:function(a){e.modalExpensesRegister=a},expression:"modalExpensesRegister"}}),e.$helpers.canView(e.roles.GERENCIA)?s("ModalExpensesTypes",{model:{value:e.modalExpensesTypes,callback:function(a){e.modalExpensesTypes=a},expression:"modalExpensesTypes"}}):e._e(),e.$helpers.canView(e.roles.GERENCIA)?s("ModalProductTypes",{model:{value:e.modalProductTypes,callback:function(a){e.modalProductTypes=a},expression:"modalProductTypes"}}):e._e(),s("div",{staticClass:"d-flex flex-column flex-sm-row justify-content-between mb-2"},[s("AppButton",{staticClass:"flex-grow-1 flex-sm-grow-0 me-1 me-sm-0 mb-2 mb-sm-0",attrs:{icon:e.icons.faPlus,color:"success","btn-class":"fw-bold"},on:{click:e.onRegisterExpenseClick}},[e._v(" Cadastrar despesa ")]),s("div",{staticClass:"d-flex"},[e.$helpers.canView(e.roles.GERENCIA)?s("AppButton",{staticClass:"me-2",attrs:{outlined:"",icon:e.icons.faList},on:{click:e.onProductTypesClick}},[e._v(" Tipos de produtos ")]):e._e(),e.$helpers.canView(e.roles.GERENCIA)?s("AppButton",{staticClass:"flex-grow-1 flex-sm-grow-0 ms-1 ms-sm-0",attrs:{outlined:"",icon:e.icons.faList},on:{click:e.onExpensesTypesClick}},[e._v(" Tipos de despesas ")]):e._e()],1)],1),s("div",{staticClass:"col col-sm-4 ms-auto"},[s("AppInput",{attrs:{name:"search",placeholder:"Buscar por descrição","default-margin":!1},on:{keypress:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.onSearchClick.apply(null,arguments)}},scopedSlots:e._u([{key:"append",fn:function(){return[s("AppButton",{attrs:{outlined:"",icon:e.icons.faSearch},on:{click:e.onSearchClick}})]},proxy:!0}]),model:{value:e.search,callback:function(a){e.search=a},expression:"search"}}),s("div",{staticClass:"text-end small py-1"},[e.search?s("span",{staticClass:"clickable link-primary",on:{click:e.onSearchClear}},[e._v("Limpar busca")]):e._e(),e._v("  ")])],1)],1)},de=[],ce=n(le,pe,de,!1,null,null,null,null);const ue=ce.exports,me={metaInfo(){return{title:"Despesas"}},components:{TheExpensesReportCard:N,TheExpensesBody:ie,TheExpensesHeader:ue},apollo:{expenses:{query:f,variables(){return{descriptionLike:`%${this.search}%`,page:this.page}}}},data(){return{page:1,search:"",vias:[],modalReport:{value:!1,src:""},expenses:{data:[],paginatorInfo:{}},expenseTypes:[]}},computed:{isLoading(){return!!this.$apollo.queries.expenses.loading}},methods:{onReportGenerated(t){this.modalReport.src=t,this.modalReport.value=!0},onCloseModalReport(){this.modalReport.src=""},onSearch(t){this.search=t}}};var fe=function(){var e=this,s=e._self._c;return s("div",{staticClass:"py-5"},[s("AppFileModal",{attrs:{id:"expensesReport",src:e.modalReport.src,title:"Relatório das despesas"},on:{hidden:e.onCloseModalReport},model:{value:e.modalReport.value,callback:function(a){e.$set(e.modalReport,"value",a)},expression:"modalReport.value"}}),s("TheExpensesReportCard",{staticClass:"mb-2",on:{"report-generated":e.onReportGenerated}}),s("TheExpensesHeader",{on:{search:e.onSearch}}),s("TheExpensesBody",{attrs:{expenses:e.expenses.data,pagination:e.expenses.paginatorInfo,page:e.page,"is-loading":e.isLoading},on:{"update:page":function(a){e.page=a}}})],1)},_e=[],xe=n(me,fe,_e,!1,null,null,null,null);const Be=xe.exports;export{Be as default};
