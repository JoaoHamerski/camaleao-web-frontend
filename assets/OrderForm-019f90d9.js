import{b6 as B,t as V,b7 as U,b8 as g,b9 as D,ba as j,bb as H,aI as Q,n as m,_ as W,bc as Y,ap as Z,q as K,a as G,a6 as X,z as x,bd as J,p as I,be as O,ax as E,B as ee,o as te,bf as A,m as f,i as h,bg as ne,aq as ie,E as se,x as $,F as ae,O as T,N as re,u as oe,a4 as le}from"./index-4e05606f.js";import{g as me,C as de}from"./Order-ebd7beca.js";import{G as ce}from"./GarmentMatch-c1c5c90c.js";import{b as ue}from"./Resources-b591129f.js";import{m as pe,b as q,a as fe,d as he}from"./masks-168ccaff.js";import{f as _e}from"./filesMixin-04d56c50.js";import{p as ve}from"./pasteFilesMixin-1129ca11.js";import{t as R}from"./truncate-000a7a5d.js";import{G as ge}from"./Via-eb0eedf9.js";import{s as ye}from"./sumBy-00ae31b9.js";import{o as be}from"./omit-49c12860.js";import{p as Ce}from"./pick-1b0437b0.js";function $e(){}function ke(n,e,t,i){for(var s=n.length,a=t+(i?1:-1);i?a--:++a<s;)if(e(n[a],a,n))return a;return-1}function xe(n){return n!==n}function Ie(n,e,t){for(var i=t-1,s=n.length;++i<s;)if(n[i]===e)return i;return-1}function Fe(n,e,t){return e===e?Ie(n,e,t):ke(n,xe,t)}function we(n,e){var t=n==null?0:n.length;return!!t&&Fe(n,e,0)>-1}function Se(n,e,t){for(var i=-1,s=n==null?0:n.length;++i<s;)if(t(e,n[i]))return!0;return!1}function Ae(n){return typeof n=="function"?n:B}var Te=9007199254740991,y=4294967295,ze=Math.min;function Me(n,e){if(n=V(n),n<1||n>Te)return[];var t=y,i=ze(n,y);e=Ae(e),n-=y;for(var s=U(i,e);++t<n;)e(t);return s}var Ne=1/0,De=g&&1/D(new g([,-0]))[1]==Ne?function(n){return new g(n)}:$e;const Ge=De;var Oe=200;function Ee(n,e,t){var i=-1,s=we,a=n.length,o=!0,r=[],l=r;if(t)o=!1,s=Se;else if(a>=Oe){var c=e?null:Ge(n);if(c)return D(c);o=!1,s=H,l=new j}else l=e?[]:r;e:for(;++i<a;){var d=n[i],u=e?e(d):d;if(d=t||d!==0?d:0,o&&u===u){for(var S=l.length;S--;)if(l[S]===u)continue e;e&&l.push(u),r.push(d)}else s(l,u,t)||(l!==r&&l.push(u),r.push(d))}return r}function qe(n,e){return n&&n.length?Ee(n,Q(e)):[]}var p={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ClothingTypeParts"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ClothingType"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_hidden"},arguments:[],directives:[]}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetClothingTypes"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"is_hidden"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"clothingTypes"},arguments:[{kind:"Argument",name:{kind:"Name",value:"is_hidden"},value:{kind:"Variable",name:{kind:"Name",value:"is_hidden"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ClothingTypeParts"},directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateClothingType"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClothingTypeInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"clothingTypeCreate"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateClothingType"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClothingTypeInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"clothingTypeUpdate"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ClothingTypeParts"},directives:[]}]}}]}}],loc:{start:0,end:453}};p.loc.source={body:`fragment ClothingTypeParts on ClothingType {
  id
  key
  name
  is_hidden
}

query GetClothingTypes($is_hidden: Boolean) {
  clothingTypes(is_hidden: $is_hidden) {
    ...ClothingTypeParts
  }
}

mutation CreateClothingType($input: ClothingTypeInput!) {
  clothingTypeCreate(input: $input) {
    id
  }
}

mutation UpdateClothingType($id: ID!, $input: ClothingTypeInput!) {
  clothingTypeUpdate(id: $id, input: $input) {
    ...ClothingTypeParts
  }
}
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function _(n,e){if(n.kind==="FragmentSpread")e.add(n.name.value);else if(n.kind==="VariableDefinition"){var t=n.type;t.kind==="NamedType"&&e.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(i){_(i,e)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(i){_(i,e)}),n.definitions&&n.definitions.forEach(function(i){_(i,e)})}var k={};(function(){p.definitions.forEach(function(e){if(e.name){var t=new Set;_(e,t),k[e.name.value]=t}})})();function z(n,e){for(var t=0;t<n.definitions.length;t++){var i=n.definitions[t];if(i.name&&i.name.value==e)return i}}function v(n,e){var t={kind:n.kind,definitions:[z(n,e)]};n.hasOwnProperty("loc")&&(t.loc=n.loc);var i=k[e]||new Set,s=new Set,a=new Set;for(i.forEach(function(r){a.add(r)});a.size>0;){var o=a;a=new Set,o.forEach(function(r){if(!s.has(r)){s.add(r);var l=k[r]||new Set;l.forEach(function(c){a.add(c)})}})}return s.forEach(function(r){var l=z(n,r);l&&t.definitions.push(l)}),t}v(p,"ClothingTypeParts");const Re=v(p,"GetClothingTypes");v(p,"CreateClothingType");v(p,"UpdateClothingType");const Le={props:{form:{type:Object,required:!0}},data(){return{isLoadingClients:!1,clients:[]}},methods:{getWhereClause(n){return this.$helpers.isNumeric(n)?{column:"PHONE",operator:"LIKE",value:`%${n}%`}:{column:"NAME",operator:"LIKE",value:`%${n}%`}},async onClientSearch(n){if(this.isLoadingClients=!0,n===""){this.clients=[],this.isLoadingClients=!1;return}const{data:{clients:e}}=await this.$apollo.query({query:ue,variables:{where:this.getWhereClause(n),orderBy:[{column:"NAME",order:"ASC"}]}});this.isLoadingClients=!1,this.clients=e.data},clientCustomLabel(n){return n.phone?`${n.name} - ${W(n.phone)}`:n.name}}};var Pe=function(){var e=this,t=e._self._c;return t("AppContainer",{staticClass:"mb-4",scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" Cliente do pedido ")]},proxy:!0},{key:"body",fn:function(){return[t("AppSelect",{attrs:{id:"client_id",value:e.form.client_id,name:"client_id","track-by":"id",options:e.clients,"custom-label":e.clientCustomLabel,loading:e.isLoadingClients,placeholder:"Busque um cliente...",error:e.form.errors.get("client_id")},on:{input:function(i){return e.form.set({client_id:i})},"search-change":e.onClientSearch},scopedSlots:e._u([{key:"noOptions",fn:function(){return[e._v(" Faça uma busca para exibir resultados ")]},proxy:!0}])},[e._v(" Nome ou telefone do cliente: ")])]},proxy:!0}])})},Be=[],Ve=m(Le,Pe,Be,!1,null,null,null,null);const Ue=Ve.exports,je={props:{form:{type:Object,required:!0}},data:()=>({icons:{faFileContract:Y}})};var He=function(){var e=this,t=e._self._c;return t("AppContainer",{scopedSlots:e._u([{key:"title",fn:function(){return[t("FontAwesomeIcon",{attrs:{icon:e.icons.faFileContract,"fixed-width":""}}),e._v(" Informações básicas ")]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 col-sm"},[t("AppInput",{attrs:{id:"name",value:e.form.name,name:"name",placeholder:"Nome que descreva o pedido...",label:"Nome",error:e.form.errors.get("name"),optional:""},on:{input:function(i){return e.form.set({name:i})}}})],1),t("div",{staticClass:"col-12 col-sm"},[t("AppInput",{attrs:{id:"code",value:e.form.code,name:"code",placeholder:"Código do pedido...",error:e.form.errors.get("code"),label:"Código"},on:{input:function(i){return e.form.set({code:i})}}})],1)])]},proxy:!0}])})},Qe=[],We=m(je,He,Qe,!1,null,null,null,null);const Ye=We.exports,Ze={props:{form:{type:Object,required:!0}},data(){return{maskDate:pe,icons:{faCalendarAlt:Z}}}};var Ke=function(){var e=this,t=e._self._c;return t("AppContainer",{staticClass:"mt-3",scopedSlots:e._u([{key:"title",fn:function(){return[t("FontAwesomeIcon",{attrs:{icon:e.icons.faCalendarAlt,"fixed-width":""}}),e._v(" Datas ")]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 col-sm"},[t("AppInput",{attrs:{id:"delivery_date",value:e.form.delivery_date,name:"delivery_date",type:"date",placeholder:"dd/mm/aaaa",mask:e.maskDate,numeric:"",error:e.form.errors.get("delivery_date")},on:{input:function(i){return e.form.set({delivery_date:i})}}},[e._v(" Data de entrega ")])],1)])]},proxy:!0}])})},Xe=[],Je=m(Ze,Ke,Xe,!1,null,null,null,null);const et=Je.exports,tt={props:{items:{type:Array,default:()=>[]},maxFileSize:{type:Number,default:null}},data(){return{icons:{faUpload:K}}},methods:{formatBytes:G,truncate:R,onCancelClick(){this.$emit("cancel")},emitFieldToTransfer(n){this.$emit("transfer-to-field",n)},onDeleteFile(n){this.$emit("delete-file",n)}}};var nt=function(){var e=this,t=e._self._c;return t("AppModal",e._g(e._b({attrs:{id:"orderFormFilesModal",centered:""},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" Escolha onde deseja anexar o(s) arquivo(s) ")]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"mb-3"},[t("AppViewerItems",{attrs:{"max-file-size":e.maxFileSize,col:"6","show-delete-button":"",files:e.items},on:{"delete-file":e.onDeleteFile},scopedSlots:e._u([{key:"file-info",fn:function({file:i}){return[t("div",{staticClass:"small text-secondary text-center"},[e._v(" ("+e._s(e.truncate(i.name,{length:15}))+" - "),t("b",[e._v(e._s(e.formatBytes(i.size)))]),e._v(") ")])]}}])})],1),t("div",{staticClass:"d-flex flex-column justify-content-center"},[t("AppButton",{staticClass:"fw-bold d-block mb-3",attrs:{type:"button",icon:e.icons.faUpload},on:{click:function(i){return e.emitFieldToTransfer("art_paths")}}},[t("br"),e._v("Imagens da arte ")]),t("AppButton",{staticClass:"fw-bold d-block mb-3",attrs:{type:"button",icon:e.icons.faUpload},on:{click:function(i){return e.emitFieldToTransfer("size_paths")}}},[t("br"),e._v("Imagens do tamanho ")]),t("AppButton",{staticClass:"fw-bold d-block mb-3",attrs:{type:"button",icon:e.icons.faUpload},on:{click:function(i){return e.emitFieldToTransfer("payment_voucher_paths")}}},[t("br"),e._v("Comprovantes de pagamento ")])],1),t("div",{staticClass:"text-end"},[t("AppButton",{attrs:{type:"button","data-bs-dismiss":"modal",color:"light"},on:{click:e.onCancelClick}},[e._v(" Cancelar ")])],1)]},proxy:!0}])},"AppModal",e.$attrs,!1),e.$listeners))},it=[],st=m(tt,nt,it,!1,null,null,null,null);const at=st.exports,b={art_paths:"image",size_paths:"image",payment_voucher_paths:["image","pdf"]},rt={components:{OrderFormFilesModal:at},mixins:[_e,ve],props:{form:{type:Object,required:!0},isEdit:{type:Boolean,default:!1}},data(){return{VALID_TYPES:b,maxFileSize:1048576,modal:!1,transferredItems:[],pasteEnabled:!1,icons:{faFileAlt:X}}},watch:{transferredItems(n){n.length===0&&(this.modal=!1)}},mounted(){document.addEventListener("paste",this.onPasteEvent)},beforeDestroy(){document.removeEventListener("paste",this.onPasteEvent)},methods:{formatBytes:G,truncate:R,afterPaste(n){this.transferredItems=n,this.modal=!0},async onFileSelected(n,e){const t=await this.getBase64Files(n),i=this.getOnlyValidFiles(t,b[e]);this.$emit("selected-files",{files:i,field:e})},onTransferToField(n){const e=this.getOnlyValidFiles(this.transferredItems,b[n]);this.$emit("selected-files",{files:e,field:n}),this.modal=!1,this.transferredItems=[]},onFileDelete(n,e){this.$emit("delete-file",{fileKey:n,field:e})},onCancel(){this.transferredItems=[]},onModalDeleteFile(n){const e=this.transferredItems.findIndex(t=>t.key===n);this.transferredItems.splice(e,1)}}};var ot=function(){var e=this,t=e._self._c;return t("AppContainer",{scopedSlots:e._u([{key:"title",fn:function(){return[t("FontAwesomeIcon",{attrs:{icon:e.icons.faFileAlt,"fixed-width":""}}),e._v(" Anexos ")]},proxy:!0},{key:"body",fn:function(){return[t("OrderFormFilesModal",{attrs:{"max-file-size":e.maxFileSize,items:e.transferredItems},on:{cancel:e.onCancel,"transfer-to-field":e.onTransferToField,"delete-file":e.onModalDeleteFile},model:{value:e.modal,callback:function(i){e.modal=i},expression:"modal"}}),t("div",{staticClass:"fw-bold small text-secondary mb-3"},[e._v(" Tamanho máximo para cada arquivo: "+e._s(e.formatBytes(e.maxFileSize))+" ")]),t("div",[t("AppInputFile",{attrs:{id:"art_paths",centered:"",multiple:"",optional:"",accept:"image/*"},on:{input:function(i){return e.onFileSelected(i,"art_paths")}}},[e._v(" Imagens da arte ")]),t("AppViewerItems",{attrs:{"show-delete-button":"",files:e.form.art_paths,"max-file-size":e.maxFileSize},on:{"delete-file":function(i){return e.onFileDelete(i,"art_paths")}},scopedSlots:e._u([e.isEdit?null:{key:"file-info",fn:function({file:i}){return[t("div",{staticClass:"small text-secondary text-center"},[e._v(" ("+e._s(e.truncate(i.name,{length:15}))+" - "),t("b",[e._v(e._s(e.formatBytes(i.size)))]),e._v(") ")])]}}],null,!0)})],1),t("div",[t("AppInputFile",{attrs:{id:"size_paths",centered:"",multiple:"",optional:"",accept:"image/*"},on:{input:function(i){return e.onFileSelected(i,"size_paths")}}},[e._v(" Imagens do tamanho ")]),t("AppViewerItems",{attrs:{"show-delete-button":"",files:e.form.size_paths,"max-file-size":e.maxFileSize},on:{"delete-file":function(i){return e.onFileDelete(i,"size_paths")}},scopedSlots:e._u([e.isEdit?null:{key:"file-info",fn:function({file:i}){return[t("div",{staticClass:"small text-secondary text-center"},[e._v(" ("+e._s(e.truncate(i.name,{length:15}))+" - "),t("b",[e._v(e._s(e.formatBytes(i.size)))]),e._v(") ")])]}}],null,!0)})],1),t("AppInputFile",{attrs:{id:"payment_voucher_paths",centered:"",multiple:"",optional:"",accept:"image/*,application/pdf"},on:{input:function(i){return e.onFileSelected(i,"payment_voucher_paths",e.VALID_TYPES.payment_voucher_paths)}}},[e._v(" Comprovantes de pagamento ")]),t("AppViewerItems",{attrs:{"show-delete-button":"","list-type":"card",files:e.form.payment_voucher_paths,"max-file-size":e.maxFileSize},on:{"delete-file":function(i){return e.onFileDelete(i,"payment_voucher_paths")}},scopedSlots:e._u([e.isEdit?null:{key:"file-info",fn:function({file:i}){return[t("div",{staticClass:"small text-secondary text-center"},[e._v(" ("),t("span",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"bottom"},expression:"{placement: 'bottom'}"}],attrs:{content:i.name}},[e._v(e._s(e.truncate(i.name,{length:15}))+" ")]),e._v(" - "),t("b",[e._v(e._s(e.formatBytes(i.size)))]),e._v(") ")])]}}],null,!0)})]},proxy:!0}])})},lt=[],mt=m(rt,ot,lt,!1,null,null,null,null);const dt=mt.exports,ct={props:{garment:{type:Object,required:!0},isDeleteGarmentDisabled:{type:Boolean,default:!1}},data:()=>({icons:{faPlus:x,faPaste:J,faTrashAlt:I,faLightbulb:O,faListUl:E}}),methods:{onNewClick(){this.$emit("new-garment")},onDuplicateClick(){this.$emit("duplicate-garment",{...this.garment})},onDeleteClick(){this.$emit("delete-garment",this.garment)},onHowToUseClick(){this.$emit("how-to-use")},onMatchesClick(){this.$emit("show-matches")}}};var ut=function(){var e=this,t=e._self._c;return t("div",{staticClass:"d-flex justify-content-between"},[t("div",{staticClass:"small"},[t("a",{staticClass:"text-decoration-none",attrs:{href:""},on:{click:function(i){return i.preventDefault(),e.onNewClick.apply(null,arguments)}}},[t("FontAwesomeIcon",{attrs:{icon:e.icons.faPlus}}),e._v(" Novo ")],1),t("a",{staticClass:"text-decoration-none mx-3",attrs:{href:""},on:{click:function(i){return i.preventDefault(),e.onDuplicateClick.apply(null,arguments)}}},[t("FontAwesomeIcon",{attrs:{icon:e.icons.faPaste}}),e._v(" Duplicar ")],1),e.isDeleteGarmentDisabled?e._e():t("a",{staticClass:"text-decoration-none",attrs:{href:""},on:{click:function(i){return i.preventDefault(),e.onDeleteClick.apply(null,arguments)}}},[t("FontAwesomeIcon",{attrs:{icon:e.icons.faTrashAlt}}),e._v(" Deletar ")],1)]),t("div",[t("div",[t("a",{staticClass:"fw-bold small text-decoration-none",attrs:{href:""},on:{click:function(i){return i.preventDefault(),e.onHowToUseClick.apply(null,arguments)}}},[t("FontAwesomeIcon",{attrs:{icon:e.icons.faLightbulb,"fixed-width":""}}),e._v(" Como usar ")],1)]),t("div",[t("a",{staticClass:"fw-bold small text-decoration-none",attrs:{href:""},on:{click:function(i){return i.preventDefault(),e.onMatchesClick.apply(null,arguments)}}},[t("FontAwesomeIcon",{attrs:{icon:e.icons.faListUl,"fixed-width":""}}),e._v(" Combinações ")],1)])])])},pt=[],ft=m(ct,ut,pt,!1,null,null,null,null);const ht=ft.exports,_t={props:{possibleMatch:{type:Object,default:()=>({})}},methods:{get:ee,onFillClick(){this.$emit("fill-options")}}};var vt=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"small"},[t("span",{staticClass:"text-success"},[e._v("Apenas uma combinação possível")]),t("span",{staticClass:"link-primary fw-bold clickable ms-1",on:{click:function(i){return i.preventDefault(),e.onFillClick.apply(null,arguments)}}},[e._v("(preencher)")])]),t("table",{staticClass:"table table-sm table-bordered"},[t("tbody",[t("tr",[t("td",{staticClass:"fw-bold"},[e._v(" Modelo ")]),t("td",[e._v(e._s(e.get(e.possibleMatch,"model.name","N/A")))])]),t("tr",[t("td",{staticClass:"fw-bold"},[e._v(" Material ")]),t("td",[e._v(e._s(e.get(e.possibleMatch,"material.name","N/A")))])]),t("tr",[t("td",{staticClass:"fw-bold"},[e._v(" Tipo de gola ")]),t("td",[e._v(e._s(e.get(e.possibleMatch,"neck_type.name","N/A")))])]),t("tr",[t("td",{staticClass:"fw-bold"},[e._v(" Tipo de manga ")]),t("td",[e._v(e._s(e.get(e.possibleMatch,"sleeve_type.name","N/A")))])])])])])},gt=[],yt=m(_t,vt,gt,!1,null,null,null,null);const bt=yt.exports,M=(n,e)=>{const t=n.map(i=>i[e]).filter(i=>i!==null);return qe(t,"id")},C=["model","material","neck_type","sleeve_type"],Ct={components:{FormGarmentItemMatchesPossible:bt},props:{index:{type:Number,required:!0},form:{type:Object,required:!0},garmentMatches:{type:Array,default:()=>[]},matched:{type:Boolean,default:!1}},data:()=>({icons:{faSyncAlt:te},possibleMatch:null,models:[],materials:[],neckTypes:[],sleeveTypes:[],filteredMatches:[]}),computed:{formGarment(){return this.form.garments[this.index]},modelError(){return this.form.errors.get(`garments.${this.index}.match_id`)}},beforeMount(){this.populateSelectOptions()},mounted(){this.onOptionsChanged()},methods:{populateSelectOptions(){for(const n of C){const e=A(n)+"s",t=M(this.garmentMatches,n);this[e]=t.map(i=>({...i,disabled:!1}))}},disableUnmatchedOptions(n){for(const e of C){const t=A(e)+"s";if(!this[t]||t==="models")continue;const i=f(M(n,e),"id");this[t].forEach(s=>{s.disabled=!1,i.includes(s.id)||(s.disabled=!0)})}},filterGarmentMatches(){const{model_id:n,material_id:e,neck_type_id:t,sleeve_type_id:i}=this.formGarment,s=(o,r)=>h(r)?!0:o===r,a=this.garmentMatches.filter(o=>{var r,l,c,d;return s(((r=o.model)==null?void 0:r.id)||"",n)&&s(((l=o.material)==null?void 0:l.id)||"",e)&&s(((c=o.neck_type)==null?void 0:c.id)||"",t)&&s(((d=o.sleeve_type)==null?void 0:d.id)||"",i)});return this.disableUnmatchedOptions(a),a},onModelChange(){this.resetFormMatch(!1)},isExactMatch(n){return n===null?!1:C.every(e=>h(this.formGarment[e+"_id"])?h(n[e]):this.formGarment[e+"_id"]===n[e].id)},getPossibleMatch(n){return n.length===1?n[0]:n.every(t=>n.every(i=>{var s,a,o,r,l,c,d,u;return((s=t.model)==null?void 0:s.id)===((a=i.model)==null?void 0:a.id)&&((o=t.material)==null?void 0:o.id)===((r=i.material)==null?void 0:r.id)&&((l=t.neck_type)==null?void 0:l.id)===((c=i.neck_type)==null?void 0:c.id)&&((d=t.sleeve_type)==null?void 0:d.id)===((u=i.sleeve_type)==null?void 0:u.id)}))?n.find(i=>i.deleted_at)??n[0]:null},onOptionsChanged(){const n=this.filterGarmentMatches();this.possibleMatch=null,this.$emit("matched",null),this.possibleMatch=this.getPossibleMatch(n),this.isExactMatch(this.possibleMatch)&&this.onExactMatchFound(this.possibleMatch)},fillWithPossibleMatch(){var e,t,i,s;const n=this.possibleMatch;this.form.set({[`garments.${this.index}.model_id`]:((e=n.model)==null?void 0:e.id)||"",[`garments.${this.index}.material_id`]:((t=n.material)==null?void 0:t.id)||"",[`garments.${this.index}.neck_type_id`]:((i=n.neck_type)==null?void 0:i.id)||"",[`garments.${this.index}.sleeve_type_id`]:((s=n.sleeve_type)==null?void 0:s.id)||""}),this.onOptionsChanged()},resetFormMatch(n){this.form.set({[`garments.${this.index}.material_id`]:"",[`garments.${this.index}.neck_type_id`]:"",[`garments.${this.index}.sleeve_type_id`]:""}),n&&(this.possibleMatch=null),this.filterGarmentMatches()},onExactMatchFound(n){this.$emit("matched",n),this.possibleMatch=null}}};var $t=function(){var e=this,t=e._self._c;return t("div",[e.form.errors.has(`garments.${e.index}.match_id`)?t("AppAlert",{attrs:{dismissible:"",small:"",color:"danger"}},[e._v(" "+e._s(e.form.errors.get(`garments.${e.index}.match_id`))+" ")]):e._e(),t("span",{staticClass:"link-primary clickable fw-bold small",on:{click:function(i){return i.preventDefault(),e.resetFormMatch(!0)}}},[t("FontAwesomeIcon",{attrs:{icon:e.icons.faSyncAlt,"fixed-width":""}}),e._v(" Resetar ")],1),t("div",{staticClass:"row",on:{"!change":function(i){return e.onOptionsChanged.apply(null,arguments)}}},[t("div",{staticClass:"col"},[t("AppSimpleSelect",{attrs:{id:`garments.${e.index}.model_id`,name:`garments.${e.index}.model_id`,value:e.form.garments[e.index].model_id,"label-prop":"name",placeholder:"Selecione um modelo",options:e.models,"select-class":["form-select-sm",{"is-valid":e.matched}]},on:{change:e.onModelChange,input:function(i){return e.form.set({[`garments.${e.index}.model_id`]:i})}}},[e._v(" Modelo ")])],1),t("div",{staticClass:"col"},[t("AppSimpleSelect",{attrs:{id:`garments.${e.index}.material_id`,name:`garments.${e.index}.material_id`,value:e.form.garments[e.index].material_id,"label-prop":"name",placeholder:"Selecione um material",options:e.materials,"select-class":["form-select-sm",{"is-valid":e.matched}],disabled:!e.formGarment.model_id},on:{input:function(i){return e.form.set({[`garments.${e.index}.material_id`]:i})}}},[e._v(" Material ")])],1),t("div",{staticClass:"col"},[t("AppSimpleSelect",{attrs:{id:`garments.${e.index}.neck_type_id`,name:`garments.${e.index}.neck_type_id`,value:e.form.garments[e.index].neck_type_id,"label-prop":"name",placeholder:"Selecione um tipo",options:e.neckTypes,"select-class":["form-select-sm",{"is-valid":e.matched}],disabled:!e.formGarment.model_id},on:{input:function(i){return e.form.set({[`garments.${e.index}.neck_type_id`]:i})}}},[e._v(" Tipo de gola ")])],1),t("div",{staticClass:"col"},[t("AppSimpleSelect",{attrs:{id:`garments.${e.index}.sleeve_type_id`,name:`garments.${e.index}.sleeve_type_id`,value:e.form.garments[e.index].sleeve_type_id,"label-prop":"name",placeholder:"Selecione um tipo",options:e.sleeveTypes,"select-class":["form-select-sm",{"is-valid":e.matched}],disabled:!e.formGarment.model_id},on:{input:function(i){return e.form.set({[`garments.${e.index}.sleeve_type_id`]:i})}}},[e._v(" Tipo de manga ")])],1)]),e.possibleMatch?t("FormGarmentItemMatchesPossible",{attrs:{"possible-match":e.possibleMatch},on:{"fill-options":e.fillWithPossibleMatch}}):e._e()],1)},kt=[],xt=m(Ct,$t,kt,!1,null,null,null,null);const It=xt.exports,Ft={props:{garmentIndex:{type:Number,required:!0},form:{type:Object,required:!0},sizesOptions:{type:Array,default:()=>[]}},data:()=>({icons:{faPlus:x,faTrashAlt:I},maskInteger:q({numeralIntegerScale:3,stripLeadingZeroes:!1,numeralDecimalScale:0})}),computed:{isDeletedDisabled(){return this.form.garments[this.garmentIndex].items_individual.length<=1}},methods:{onNewGarmentSize(){this.$emit("new-garment-size",{garmentIndex:this.garmentIndex,isIndividual:!0})},onDeleteGarmentSize(n){this.$emit("delete-garment-size",{index:n,garmentIndex:this.garmentIndex,isIndividual:!0})}}};var wt=function(){var e=this,t=e._self._c;return t("div",[e._m(0),e._l(e.form.garments[e.garmentIndex].items_individual,function(i,s){return[t("div",{key:s,staticClass:"row mb-2"},[t("div",{staticClass:"col-3"},[t("AppSimpleSelect",{attrs:{id:`garments.${e.garmentIndex}.items.${s}.size_id`,name:`garments.${e.garmentIndex}.items.${s}.size_id`,value:e.form.garments[e.garmentIndex].items_individual[s].size_id,options:e.sizesOptions,"label-prop":"name",placeholder:"Selecione um tam.","select-class":"form-select-sm","remove-default-margin":"",error:e.form.errors.has(`garments.${e.garmentIndex}.items.${s}.size_id`)},on:{input:function(a){return e.form.set({[`garments.${e.garmentIndex}.items_individual.${s}.size_id`]:a})}}})],1),t("div",{staticClass:"col-3"},[t("AppInput",{attrs:{id:`garments.${e.garmentIndex}.items.${s}.name`,name:`garments.${e.garmentIndex}.items.${s}.name`,value:e.form.garments[e.garmentIndex].items_individual[s].name,"input-class":"form-control-sm","default-margin":!1,placeholder:"Digite o nome..."},on:{input:function(a){return e.form.set({[`garments.${e.garmentIndex}.items_individual.${s}.name`]:a})}}})],1),t("div",{staticClass:"col-2"},[t("AppInput",{attrs:{id:`garments.${e.garmentIndex}.items.${s}.number`,name:`garments.${e.garmentIndex}.items.${s}.number`,value:e.form.garments[e.garmentIndex].items_individual[s].number,"input-class":"form-control-sm","default-margin":!1,placeholder:"Número...",mask:e.maskInteger},on:{input:function(a){return e.form.set({[`garments.${e.garmentIndex}.items_individual.${s}.number`]:a})}}})],1),t("div",{staticClass:"col-3"},[t("AppButton",{staticClass:"me-2",attrs:{"btn-class":"btn-sm",icon:e.icons.faPlus,outlined:"",color:"success"},on:{click:function(a){return a.preventDefault(),e.onNewGarmentSize.apply(null,arguments)}}}),t("AppButton",{attrs:{"btn-class":"btn-sm",icon:e.icons.faTrashAlt,outlined:"",color:"danger",disabled:e.isDeletedDisabled},on:{click:function(a){return a.preventDefault(),e.onDeleteGarmentSize(s)}}})],1)])]})],2)},St=[function(){var n=this,e=n._self._c;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-3 small"},[n._v(" Tamanho ")]),e("div",{staticClass:"col-3 small"},[n._v(" Nome ")]),e("div",{staticClass:"col-2 small"},[n._v(" Número ")])])}],At=m(Ft,wt,St,!1,null,null,null,null);const Tt=At.exports,zt={props:{garmentIndex:{type:Number,required:!0},form:{type:Object,required:!0},sizesOptions:{type:Array,default:()=>[]}},data:()=>({icons:{faPlus:x,faTrashAlt:I},maskInteger:q({numeralIntegerScale:3,stripLeadingZeroes:!0,numeralDecimalScale:0})}),computed:{isDeletedDisabled(){return this.form.garments[this.garmentIndex].items.length<=1}},methods:{onNewGarmentSize(){this.$emit("new-garment-size",{garmentIndex:this.garmentIndex,isIndividual:!1})},onDeleteGarmentSize(n){this.$emit("delete-garment-size",{index:n,garmentIndex:this.garmentIndex,isIndividual:!1})}}};var Mt=function(){var e=this,t=e._self._c;return t("div",[e._m(0),e._l(e.form.garments[e.garmentIndex].items,function(i,s){return[t("div",{key:s,staticClass:"row mb-2"},[t("div",{staticClass:"col-3"},[t("AppSimpleSelect",{attrs:{id:`garments.${e.garmentIndex}.items.${s}.size_id`,name:`garments.${e.garmentIndex}.items.${s}.size_id`,value:e.form.garments[e.garmentIndex].items[s].size_id,options:e.sizesOptions,"label-prop":"name",placeholder:"Selecione um tam.","select-class":"form-select-sm","remove-default-margin":"",error:e.form.errors.has(`garments.${e.garmentIndex}.items.${s}.size_id`)},on:{input:function(a){return e.form.set({[`garments.${e.garmentIndex}.items.${s}.size_id`]:a})}}})],1),t("div",{staticClass:"col-2"},[t("AppInput",{attrs:{id:`garments.${e.garmentIndex}.items.${s}.quantity`,name:`garments.${e.garmentIndex}.items.${s}.quantity`,value:e.form.garments[e.garmentIndex].items[s].quantity,"input-class":"form-control-sm","default-margin":!1,placeholder:"Qtd...",mask:e.maskInteger,error:e.form.errors.has(`garments.${e.garmentIndex}.items.${s}.quantity`)},on:{input:function(a){return e.form.set({[`garments.${e.garmentIndex}.items.${s}.quantity`]:a})}}})],1),t("div",{staticClass:"col-3"},[t("AppButton",{staticClass:"me-2",attrs:{"btn-class":"btn-sm",icon:e.icons.faPlus,outlined:"",color:"success"},on:{click:function(a){return a.preventDefault(),e.onNewGarmentSize.apply(null,arguments)}}}),t("AppButton",{attrs:{"btn-class":"btn-sm",icon:e.icons.faTrashAlt,outlined:"",color:"danger",disabled:e.isDeletedDisabled},on:{click:function(a){return a.preventDefault(),e.onDeleteGarmentSize(s)}}})],1)])]})],2)},Nt=[function(){var n=this,e=n._self._c;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-3 small"},[n._v(" Tamanho ")]),e("div",{staticClass:"col-2 small"},[n._v(" Quantidade ")])])}],Dt=m(zt,Mt,Nt,!1,null,null,null,null);const Gt=Dt.exports,Ot={components:{SizesIndividualName:Tt,SizesNoIndividualName:Gt},props:{match:{type:Object,required:!0},garmentIndex:{type:Number,required:!0},form:{type:Object,required:!0}},computed:{formGarment(){return this.form.garments[this.garmentIndex]},hasIndividualNames(){return this.form.garments[this.garmentIndex].individual_names},sizesOptions(){return this.match.sizes}},methods:{onNewGarmentSize(n){this.$emit("new-garment-size",n)},onDeleteGarmentSize(n){this.$emit("delete-garment-size",n)},onIndividualNamesChange(n){this.form.errors.clear("*"),this.form.set({[`garments.${this.garmentIndex}.individual_names`]:n})}}};var Et=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"mb-3"},[t("AppCheckboxSwitch",{attrs:{id:`garments.${e.garmentIndex}.inidividual_names`,value:e.form.garments[e.garmentIndex].individual_names},on:{input:e.onIndividualNamesChange}},[e._v(" Nomes individuais ")])],1),t("AppContainer",{attrs:{color:"secondary"},scopedSlots:e._u([{key:"title",fn:function(){return[t("small",[e._v(" Tamanhos "+e._s(e.hasIndividualNames?"(nomes individuais)":"")+" ")])]},proxy:!0},{key:"body",fn:function(){return[e.formGarment.individual_names?t("SizesIndividualName",e._b({on:{"new-garment-size":e.onNewGarmentSize,"delete-garment-size":e.onDeleteGarmentSize}},"SizesIndividualName",{garmentIndex:e.garmentIndex,form:e.form,sizesOptions:e.sizesOptions},!1)):t("SizesNoIndividualName",e._b({on:{"new-garment-size":e.onNewGarmentSize,"delete-garment-size":e.onDeleteGarmentSize}},"SizesNoIndividualName",{garmentIndex:e.garmentIndex,form:e.form,sizesOptions:e.sizesOptions},!1))]},proxy:!0}])})],1)},qt=[],Rt=m(Ot,Et,qt,!1,null,null,null,null);const Lt=Rt.exports,Pt={components:{FormGarmentItemOptions:ht,FormGarmentItemMatches:It,FormGarmentItemSizes:Lt},props:{garment:{type:Object,required:!0},garmentMatches:{type:Array,default:()=>[]},index:{type:Number,required:!0},form:{type:Object,required:!0}},data:()=>({match:null}),computed:{matched(){return this.match!==null},isDeleteGarmentDisabled(){return this.form.garments.length<=1}},methods:{onNewGarment(){this.$emit("new-garment")},onDuplicateGarment(n){this.$emit("duplicate-garment",n)},onDeleteGarment(n){this.$emit("delete-garment",n)},onNewGarmentSize(n){this.$emit("new-garment-size",n)},onDeleteGarmentSize(n){this.$emit("delete-garment-size",n)},onMatchFound(n){this.match=n,this.form.set({[`garments.${this.index}.match`]:n||null,[`garments.${this.index}.match_id`]:n?n.id:"",[`garments.${this.index}.items`]:[{...w}],[`garments.${this.index}.items_individual`]:[{...F}]})},onHowToUse(){this.$emit("how-to-use")},onShowMatches(){this.$emit("show-matches")}}};var Bt=function(){var e=this,t=e._self._c;return t("div",[t("FormGarmentItemOptions",e._b({staticClass:"mb-2",on:{"new-garment":e.onNewGarment,"duplicate-garment":e.onDuplicateGarment,"delete-garment":e.onDeleteGarment,"how-to-use":e.onHowToUse,"show-matches":e.onShowMatches}},"FormGarmentItemOptions",{garment:e.garment,isDeleteGarmentDisabled:e.isDeleteGarmentDisabled},!1)),t("FormGarmentItemMatches",e._b({on:{matched:e.onMatchFound}},"FormGarmentItemMatches",{index:e.index,form:e.form,garmentMatches:e.garmentMatches,matched:e.matched},!1)),e.matched?t("FormGarmentItemSizes",e._b({on:{"new-garment-size":e.onNewGarmentSize,"delete-garment-size":e.onDeleteGarmentSize}},"FormGarmentItemSizes",{match:e.match,garmentIndex:e.index,form:e.form},!1)):e._e()],1)},Vt=[],Ut=m(Pt,Bt,Vt,!1,null,null,null,null);const jt=Ut.exports,Ht={data:()=>({collapse1:!1,icons:{faLightbulb:O,faCaretRight:ne}})};var Qt=function(){var e=this,t=e._self._c;return t("AppModal",e._g(e._b({attrs:{id:"howToUseModal","modal-dialog-class":"modal-dialog-centered"},scopedSlots:e._u([{key:"title",fn:function(){return[t("FontAwesomeIcon",{attrs:{icon:e.icons.faLightbulb,"fixed-width":""}}),e._v(" Como usar o formulário de roupas ")]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"small mb-3",staticStyle:{"text-align":"justify"}},[e._v(" O formulário de roupas funciona com "),t("b",[e._v("combinações")]),e._v(" de diferentes campos, não é possível selecionar qualquer valor para qualquer campo. Essas "),t("b",[e._v("combinações")]),e._v(" são cadastradas pelo administrador do sistema. ")]),t("div",[t("h6",{staticClass:"fw-bold text-primary"},[e._v(" Como usar ")]),t("ol",{staticClass:"small"},[t("li",[e._v(" Selecione o campo "),t("b",[e._v("modelo")]),e._v(" para iniciar. ")]),t("li",[e._v(" Após selecionar o "),t("b",[e._v("modelo")]),e._v(", os demais campos irão atualizar para exibir as possíveis opções do modelo selecionado, "),t("b",[e._v("as opções que não estão disponíveis irão ficar cinza")]),e._v(". ")]),t("li",[e._v(" Conforme você seleciona outras opções, todas os campos irão se atualizar para refletir as opções disponíveis. ")]),t("li",[e._v("Caso apenas uma combinação seja possível, o sistema irá sugerir essa combinação para você usar e auto-preencher os campos.")]),t("li",[e._v("Quando você selecionar uma combinação que exista e seja válida, os campos irão ficar verdes, e a seção para escolher os tamanhos irá aparecer.")]),t("li",[e._v("Se os campos não estiverem verdes, é porque nenhuma combinação válida ou que exista foi selecionada, você pode conferir as combinações clicando em "),t("b",[e._v("Combinações")]),e._v(".")])])]),t("AppCollapsible",{staticClass:"mb-3",attrs:{value:!1,"hide-arrow":""},scopedSlots:e._u([{key:"header",fn:function(){return[t("h6",{staticClass:"fw-bold link-primary"},[t("FontAwesomeIcon",{attrs:{icon:e.icons.faCaretRight,"fixed-width":""}}),e._v(" Para que serve o botão Resetar? ")],1)]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"small",staticStyle:{"text-align":"justify"}},[e._v(" Conforme descrito no item 3 acima, em "),t("b",[e._v("Como usar")]),e._v(", conforme você seleciona as opções, todos campos são atualizados, e as opções que não fazem parte de uma possível combinação ficam cinzas (indisponíveis), caso queira voltar elas ao normal, você pode usar a opção "),t("b",[e._v("Resetar")]),e._v(". ")])]},proxy:!0}])}),t("AppCollapsible",{attrs:{value:!1,"hide-arrow":""},scopedSlots:e._u([{key:"header",fn:function(){return[t("h6",{staticClass:"fw-bold link-primary"},[t("FontAwesomeIcon",{attrs:{icon:e.icons.faCaretRight,"fixed-width":""}}),e._v(" Por que eu não é possível selecionar qualquer opção nos campos? ")],1)]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"small",staticStyle:{"text-align":"justify"}},[e._v(" Somente o administrador registra as opções e combinações, pois junto com elas são registrados os valores das roupas, que são automaticamente computados. ")])]},proxy:!0}])}),t("div",{staticClass:"text-end mt-3"},[t("AppButton",{attrs:{color:"light","data-bs-dismiss":"modal",type:"button"}},[e._v(" Fechar ")])],1)]},proxy:!0}])},"AppModal",e.$attrs,!1),e.$listeners))},Wt=[],Yt=m(Ht,Qt,Wt,!1,null,null,null,null);const Zt=Yt.exports,Kt={props:{matches:{type:Array,default:()=>[]}},data:()=>({icons:{faListUl:E}}),computed:{computedMatches(){return this.matches.sort((e,t)=>e.model.name<t.model.name?-1:e.model.name>t.model.name?1:0)},headers(){return[{value:"model.name",text:"Modelo"},{value:"material.name",text:"Material"},{value:"neck_type.name",text:"Tipo de gola"},{value:"sleeve_type.name",text:"Tipo de manga"}]}}};var Xt=function(){var e=this,t=e._self._c;return t("AppModal",e._g(e._b({attrs:{id:"matchesAvailableModal","modal-dialog-class":"modal-lg"},scopedSlots:e._u([{key:"title",fn:function(){return[t("FontAwesomeIcon",{attrs:{icon:e.icons.faListUl,"fixed-width":""}}),e._v(" Combinações disponíveis ")]},proxy:!0},{key:"body",fn:function(){return[t("AppTable",{attrs:{items:e.computedMatches,headers:e.headers}}),t("div",{staticClass:"d-flex justify-content-between align-items-center"},[t("div",{staticClass:"small text-secondary fw-bold"},[e._v(" Se a combinação que você precisa não consta na lista, contate o administrador. ")]),t("AppButton",{attrs:{type:"button","data-bs-dismiss":"modal",color:"light"}},[e._v(" Fechar ")])],1)]},proxy:!0}])},"AppModal",e.$attrs,!1),e.$listeners))},Jt=[],en=m(Kt,Xt,Jt,!1,null,null,null,null);const tn=en.exports,nn={components:{FormGarmentItem:jt,HowToUseModal:Zt,MatchesAvailableModal:tn},props:{form:{type:Object,required:!0},order:{type:Object,default:()=>({})},garmentMatches:{type:Array,default:()=>[]}},data:()=>({activeItem:0,howToUseModal:!1,showMatchesModal:!1,icons:{faTshirt:ie}}),computed:{navItems(){return this.form.garments.map((n,e)=>({text:`ITEM ${e+1}`,value:"nav-"+n.id}))}},methods:{onNewGarment(){this.$emit("new-garment"),this.activeItem=this.form.garments.length-1},onDuplicateGarment(n){this.$emit("duplicate-garment",n),this.activeItem=this.form.garments.length-1},onDeleteGarment(n){this.$emit("delete-garment",n),this.activeItem=this.activeItem===0?0:this.activeItem-1},onNewGarmentSize(n){this.$emit("new-garment-size",n)},onDeleteGarmentSize(n){this.$emit("delete-garment-size",n)},onHowToUse(){this.howToUseModal=!0},onShowMatches(){this.showMatchesModal=!0}}};var sn=function(){var e=this,t=e._self._c;return t("AppContainer",{scopedSlots:e._u([{key:"title",fn:function(){return[t("FontAwesomeIcon",{attrs:{icon:e.icons.faTshirt,"fixed-width":""}}),e._v(" Roupas ")]},proxy:!0},{key:"body",fn:function(){return[t("HowToUseModal",{model:{value:e.howToUseModal,callback:function(i){e.howToUseModal=i},expression:"howToUseModal"}}),t("MatchesAvailableModal",{attrs:{matches:e.garmentMatches},model:{value:e.showMatchesModal,callback:function(i){e.showMatchesModal=i},expression:"showMatchesModal"}}),t("AppNavPills",{attrs:{items:e.navItems,"no-fill":"","tabs-style":"","header-class":"small"},scopedSlots:e._u([e._l(e.form.garments,function(i){return{key:`headers.nav-${i.id}`,fn:function({item:s}){return[t("div",{key:i.id,class:{"text-success":i.total}},[e._v(" "+e._s(s.text)+" "),i.total?[e._v(" ("+e._s(e.$helpers.toBRL(i.total))+") ")]:e._e()],2)]}}}),e._l(e.form.garments,function(i,s){return{key:`nav-${i.id}`,fn:function(){return[t("FormGarmentItem",e._b({key:i.id,on:{"new-garment":e.onNewGarment,"duplicate-garment":e.onDuplicateGarment,"delete-garment":e.onDeleteGarment,"new-garment-size":e.onNewGarmentSize,"delete-garment-size":e.onDeleteGarmentSize,"how-to-use":e.onHowToUse,"show-matches":e.onShowMatches}},"FormGarmentItem",{garment:i,index:s,garmentMatches:e.garmentMatches,order:e.order,form:e.form},!1))]},proxy:!0}})],null,!0),model:{value:e.activeItem,callback:function(i){e.activeItem=i},expression:"activeItem"}})]},proxy:!0}])})},an=[],rn=m(nn,sn,an,!1,null,null,null,null);const on=rn.exports,ln={props:{client:{type:Object,default:()=>({})},form:{type:Object,required:!0},isEdit:{type:Boolean,default:!1},finalValue:{type:[String,Number],default:""}},apollo:{vias:{query:ge}},data(){return{vias:[],hasDownPayment:!1,maskCurrencyBRL:fe({numeralPositiveOnly:!0}),maskPercent:he()}}};var mn=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mt-3"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col col-sm"},[t("AppInput",{attrs:{id:"shipping_value",value:e.form.shipping_value,mask:e.maskCurrencyBRL,name:"shipping_value",numeric:"",optional:""},on:{input:function(i){return e.form.set({shipping_value:i})}}},[e._v(" Frete ")])],1),t("div",{staticClass:"col col-sm"},[t("AppInput",{attrs:{id:"discount",value:e.form.discount,mask:e.maskCurrencyBRL,name:"discount",error:e.form.errors.get("discount"),optional:"",numeric:""},on:{input:function(i){return e.form.set({discount:i})}}},[e._v(" Desconto ")])],1),e.client.client_recommended?t("div",{staticClass:"col col-sm"},[t("AppInput",{attrs:{id:"recommendation_bonus_percent",value:e.form.recommendation_bonus_percent,name:"recommendation_bonus_percent",numeric:"",mask:e.maskPercent,hint:"Valor somado ao bônus do cliente que indicou."},on:{input:function(i){return e.form.set({recommendation_bonus_percent:i})}},scopedSlots:e._u([{key:"append",fn:function(){return[t("AppButton",{attrs:{disabled:"",color:"light"}},[t("b",[e._v("%")])])]},proxy:!0}],null,!1,172152106)},[e._v(" Bônus de indicação ")])],1):e._e()]),t("div",{staticClass:"col-12 col-sm"},[t("AppInput",{attrs:{value:e.finalValue,disabled:"",name:"final_value","disabled-message":"O preço final é calculado automaticamente."}},[e._v(" Preço final ")])],1)])},dn=[],cn=m(ln,mn,dn,!1,null,null,null,null);const un=cn.exports,L=n=>n.size_id,P=n=>n.size_id&&n.quantity,pn=n=>n.match?n.individual_names?n.items_individual.some(L):n.items.some(P):!1,fn=n=>{const t=n.match.sizes;return n.individual_names?n.items_individual.reduce((i,s)=>{var o;const a=t.find(r=>r.id===s.size_id);return+(+(((o=a==null?void 0:a.pivot)==null?void 0:o.value)||0)+i).toFixed(2)},0):n.items.reduce((i,s)=>{var o;const a=t.find(r=>r.id===s.size_id);return+(+(((o=a==null?void 0:a.pivot)==null?void 0:o.value)||0)*+s.quantity).toFixed(2)+ +i},0)},hn=(n,e)=>{const t=n.values;return n.unique_value?n.unique_value:+t.find(s=>+s.start<=e&&+s.end>=e||!s.end).value},_n=n=>{if(n.individual_names)return n.items_individual.filter(L).length;const e=n.items.filter(P);return ye(e,t=>+t.quantity)},vn=n=>{if(!pn(n))return 0;const e=_n(n),t=hn(n.match,e),i=fn(n);return+(+(+e*+t).toFixed(2)+ +i).toFixed(2)},gn={components:{OrderFormValuesFinal:un},props:{form:{type:Object,required:!0},client:{type:Object,default:()=>({})}},data:()=>({icons:{faFileInvoiceDollar:se},totalGarmentsValue:""}),computed:{finalValue(){const n=this.$helpers.unformatCurrencyBRL(this.form.discount),e=this.$helpers.unformatCurrencyBRL(this.form.shipping_value),t=(+this.totalGarmentsValue+ +e).toFixed(2);return this.$helpers.toBRL((+t-+n).toFixed(2))},garments(){return this.form.garments}},watch:{form:{handler(){const n=this.garments.reduce((e,t)=>{const i=vn(t);return t.total=i,(+i+ +e).toFixed(2)},0);this.totalGarmentsValue=n},deep:!0}}};var yn=function(){var e=this,t=e._self._c;return t("AppContainer",{scopedSlots:e._u([{key:"title",fn:function(){return[t("FontAwesomeIcon",{attrs:{icon:e.icons.faFileInvoiceDollar,"fixed-width":""}}),e._v(" Valores finais ")]},proxy:!0},{key:"body",fn:function(){return[t("OrderFormValuesFinal",{attrs:{client:e.client,"final-value":e.finalValue,form:e.form}})]},proxy:!0}])})},bn=[],Cn=m(gn,yn,bn,!1,null,null,null,null);const $n=Cn.exports,kn=()=>le(()=>import("./OrderFormClothingTypes-f85a0ed7.js"),["assets/OrderFormClothingTypes-f85a0ed7.js","assets/index-4e05606f.js","assets/index-1259f392.css","assets/masks-168ccaff.js","assets/Order-ebd7beca.js","assets/_PaginatorFragment-c01a3fe7.js","assets/ActivityFragments-a3df58d3.js","assets/GarmentMatch-c1c5c90c.js","assets/Resources-b591129f.js","assets/filesMixin-04d56c50.js","assets/filter-bdbeaf8b.js","assets/pasteFilesMixin-1129ca11.js","assets/truncate-000a7a5d.js","assets/Via-eb0eedf9.js","assets/sumBy-00ae31b9.js","assets/omit-49c12860.js","assets/pick-1b0437b0.js","assets/_basePickBy-93d1e714.js","assets/OrderFormClothingTypes-ccffcefe.css"]),F={name:"",size_id:"",number:""},w={size_id:"",quantity:""},N={id:$(),individual_names:!1,model_id:"",material_id:"",neck_type_id:"",sleeve_type_id:"",items:[{...w}],items_individual:[{...F}],match:null,match_id:"",total:""},xn={components:{OrderFormClient:Ue,OrderFormBasicInfo:Ye,OrderFormClothingTypes:kn,OrderFormDates:et,OrderFormFiles:dt,OrderFormValuesFinalWrapper:$n,FormGarments:on},apollo:{clothingTypes:{query:Re,variables:{is_hidden:!1},result({data:{clothingTypes:n}}){for(const e of n)this.form.clothing_types.push({key:e.key,value:"R$ ",quantity:""})},skip(){return this.skipClothingTypesQuery}},garmentMatches:{query:ce,fetchPolicy:"no-cache",variables(){if(this.isEdit)return{order_id:this.order.id}}}},props:{client:{type:Object,default:()=>({})},order:{type:Object,default:()=>({})},isOrderPreRegistered:{type:Boolean,default:!1}},data(){return{clothingTypes:[],garmentMatches:["empty"],form:new ae({name:"",code:"",client_id:"",discount:"R$ ",shipping_value:"R$ ",payment_via_id:"",delivery_date:"",clothing_types:[],art_paths:[],size_paths:[],payment_voucher_paths:[],garments:[{...T(N)}],recommendation_bonus_percent:"10"}),isLoading:!1}},computed:{computedGarmentMatches(){return this.garmentMatches[0]==="empty"?[]:this.garmentMatches},isEdit(){return!h(this.order)},hasClothingTypes(){return this.isEdit?!!this.order.clothing_types.length:!1},skipClothingTypesQuery(){return!this.hasClothingTypes},isQueriesLoading(){return this.$apollo.loading||this.garmentMatches[0]==="empty"}},watch:{isQueriesLoading(n){!n&&this.isEdit&&this.populateForm()}},methods:{getFile(n){return n.base64||n},getFormattedGarments(){return this.form.garments.map(n=>({...be(n,["id","total","match"])}))},getFormattedForm(){var e;const n={...this.form.data()};return n.client_id=((e=n.client_id)==null?void 0:e.id)||"",n.art_paths=f(n.art_paths,this.getFile),n.size_paths=f(n.size_paths,this.getFile),n.payment_voucher_paths=f(n.payment_voucher_paths,this.getFile),n.garments=this.getFormattedGarments(),n},async update(){const n=this.getFormattedForm(),{data:{orderUpdate:{id:e,client:t}}}=await this.$apollo.mutate({mutation:me,variables:{id:this.order.id,input:{...n}}});this.$helpers.clearCacheFrom({fieldName:"weeklyProduction"}),this.$emit("success",{orderId:e,clientId:t.id})},async create(){const n=this.getFormattedForm(),{clientKey:e}=this.$route.params,{data:{orderCreate:{id:t}}}=await this.$apollo.mutate({mutation:de,variables:{client_id:e,input:n}});this.$helpers.clearCacheFrom([{id:e,__typename:"Client"},{fieldName:"orders"}]),this.$emit("success",{orderId:t,clientId:e})},populateClothingTypes(n){this.form.clothing_types.forEach((e,t)=>{const i=n.find(s=>s.key===e.key);i&&(this.form.clothing_types[t].value=this.$helpers.toBRL(i.value),this.form.clothing_types[t].quantity=i.quantity)})},getPopulatedSizes(n,e){return e?n.individual_names.map(t=>({size_id:t.size_id,name:t.name||"",number:t.number||""})):n.sizes.map(t=>({size_id:t.id,quantity:t.pivot.quantity}))},populateSizes(n,e){const t=n.individual_names?"items_individual":"items";this.form.set({[`garments.${e}.${t}`]:this.getPopulatedSizes(n,!!n.individual_names)})},populateGarments(){const n=this.order.garments;Me(n.length-1,()=>{this.onNewGarment()}),this.form.garments.forEach((e,t)=>{const i=n[t],{model:s,material:a,neck_type:o,sleeve_type:r}=i.match;Object.assign(e,{model_id:(s==null?void 0:s.id)||"",material_id:(a==null?void 0:a.id)||"",neck_type_id:(o==null?void 0:o.id)||"",sleeve_type_id:(r==null?void 0:r.id)||"",individual_names:!!i.individual_names}),this.$nextTick(()=>{this.populateSizes(i,t)})})},populateForm(){const n=Ce(this.order,["client","name","price","code","discount","shipping_value","delivery_date","art_paths","size_paths","payment_voucher_paths"]);Object.assign(this.form,{...n,client_id:n.client,discount:+n.discount==0?"R$ ":this.$helpers.toBRL(n.discount),shipping_value:+n.shipping_value==0?"R$ ":this.$helpers.toBRL(n.shipping_value),price:this.$helpers.toBRL(n.price),delivery_date:re(n.delivery_date)}),this.order.clothing_types.length?this.populateClothingTypes(this.order.clothing_types):this.populateGarments()},async onSubmit(){this.isLoading=!0;try{this.isEdit?await this.update():await this.create()}catch(n){this.isLoading=!1,oe(this,n)}},onSelectFiles({files:n,field:e}){this.form[e].push(...n)},onDeleteFile({fileKey:n,field:e}){const t=this.form[e].findIndex(i=>i.key===n||i===n);this.form[e].splice(t,1)},onNewGarment(){this.form.garments.push({...T(N),id:$()})},onDuplicateGarment(n){this.onNewGarment();const e=this.form.garments.length-1;Object.assign(this.form.garments[e],{...n,id:$()}),this.$nextTick(()=>{const t=n.items_individual.map(({size_id:s,name:a,number:o})=>({name:a,size_id:s,number:o})),i=n.items.map(({size_id:s,quantity:a})=>({size_id:s,quantity:a}));this.form.garments[e].items_individual=t,this.form.garments[e].items=i})},onDeleteGarment(n){const e=this.form.garments.findIndex(({id:t})=>t===n.id);this.form.garments.splice(e,1)},onNewGarmentSize({isIndividual:n,garmentIndex:e}){const t=n?"items_individual":"items",i=n?F:w;this.form.garments[e][t].push({...i})},onDeleteGarmentSize({isIndividual:n,index:e,garmentIndex:t}){const i=n?"items_individual":"items";this.form.garments[t][i].splice(e,1)}}};var In=function(){var e=this,t=e._self._c;return e.isQueriesLoading?t("div",{staticClass:"text-center my-5"},[e._m(0)]):t("AppForm",{attrs:{"on-submit":e.onSubmit,form:e.form}},[e.isEdit?t("OrderFormClient",{attrs:{form:e.form}}):e._e(),t("OrderFormBasicInfo",{staticClass:"mb-3",attrs:{form:e.form}}),e.hasClothingTypes?t("OrderFormClothingTypes",e._b({staticClass:"mb-3"},"OrderFormClothingTypes",{order:e.order,form:e.form,isEdit:e.isEdit,isOrderPreRegistered:e.isOrderPreRegistered,clothingTypes:e.clothingTypes},!1)):[e.hasClothingTypes?e._e():t("FormGarments",e._b({staticClass:"mb-3",on:{"new-garment":e.onNewGarment,"duplicate-garment":e.onDuplicateGarment,"delete-garment":e.onDeleteGarment,"new-garment-size":e.onNewGarmentSize,"delete-garment-size":e.onDeleteGarmentSize}},"FormGarments",{form:e.form,order:e.order,isEdit:e.isEdit,garmentMatches:e.computedGarmentMatches},!1)),e.hasClothingTypes?e._e():t("OrderFormValuesFinalWrapper",{staticClass:"mb-3",attrs:{client:e.client,form:e.form}})],t("OrderFormDates",{staticClass:"mb-3",attrs:{form:e.form}}),t("OrderFormFiles",e._b({on:{"selected-files":e.onSelectFiles,"delete-file":e.onDeleteFile}},"OrderFormFiles",{form:e.form,isEdit:e.isEdit},!1)),t("div",{staticClass:"mt-5"},[t("AppButton",{staticClass:"fw-bold",attrs:{type:"submit",loading:e.isLoading,color:"success",block:e.$isMobile}},[e._v(" "+e._s(e.isEdit?"Atualizar":"Cadastrar")+" ")])],1)],2)},Fn=[function(){var n=this,e=n._self._c;return e("div",{staticClass:"spinner-grow text-primary",attrs:{role:"status"}},[e("span",{staticClass:"visually-hidden"},[n._v("Loading...")])])}],wn=m(xn,In,Fn,!1,null,null,null,null);const Ln=wn.exports;export{Ln as O,un as a};
