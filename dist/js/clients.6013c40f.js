"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[30],{2339:function(e,t,r){r.r(t),r.d(t,{COLUMNS:function(){return B},clientsParams:function(){return D},default:function(){return Z}});var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"col col-sm-10 mx-auto py-5"},[r("TheClientsHeader",{on:{search:e.onSearch,"search-clear":e.onSearchClear}}),r("TheClientsCard",{attrs:{clients:e.clients.data,"is-loading":e.isLoading}}),r("AppPaginator",{staticClass:"mt-2",attrs:{"is-loading":e.isLoading,pagination:e.clients.paginatorInfo},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)},s=[],n=r(1436),o=r(7859),l=r(8299),i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("AppCard",{staticClass:"mt-2",attrs:{"is-loading":e.isLoading,"has-body-padding":!1,color:"primary"},scopedSlots:e._u([{key:"header",fn:function(){return[r("h6",{staticClass:"fw-bold mb-0"},[r("FontAwesomeIcon",{staticClass:"me-1",attrs:{icon:e.icons.faUsers,"fixed-width":""}}),e._v(" Clientes ")],1)]},proxy:!0},{key:"body",fn:function(){return[r("TheClientsCardTable",{attrs:{items:e.clients}})]},proxy:!0}])})},c=[],u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("AppTable",{attrs:{headers:e.headers,items:e.items,route:e.tableRowRoute},scopedSlots:e._u([{key:"items.city.name",fn:function(t){var r=t.item;return[e._v(" "+e._s(e.get(r,"city.name","N/A"))+" "),r.city?[e._v(" - "+e._s(e.get(r,"city.state.abbreviation","N/A"))+" ")]:e._e()]}}],null,!0)})},d=[],p=r(6423),m=r(5781),h={props:{items:{type:Array,default:()=>[]}},computed:{headers(){return[{text:"Nome",value:"name"},{text:"Telefone",value:"phone",format:"phone"},{text:"Cidade",value:"city.name"}]}},methods:{get:p.Z,tableRowRoute(e){return{name:m.yj.show,params:this.$helpers.getRouteParams({client:e})}}}},f=h,C=r(1001),y=(0,C.Z)(f,u,d,!1,null,null,null),v=y.exports,g={components:{TheClientsCardTable:v},props:{clients:{type:Array,default:()=>[]},isLoading:{type:Boolean,default:!1}},data(){return{icons:{faUsers:n.FVb}}}},w=g,x=(0,C.Z)(w,i,c,!1,null,null,null),b=x.exports,S=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("ClientModalNew",{on:{success:e.onNewClientSuccess},model:{value:e.newClientModal,callback:function(t){e.newClientModal=t},expression:"newClientModal"}}),r("div",{staticClass:"d-flex flex-column flex-sm-row justify-content-between"},[r("AppButton",{staticClass:"fw-bold mb-3 mb-sm-0",attrs:{color:"success"},on:{click:function(t){return t.preventDefault(),e.onNewClientClick.apply(null,arguments)}}},[r("FontAwesomeIcon",{attrs:{"fixed-width":"",icon:e.icons.faUserPlus}}),e._v(" Novo cliente ")],1),r("div",{staticClass:"col-12 col-sm-5"},[r("AppInput",{attrs:{name:"search","default-margin":!1,placeholder:"Digite a busca..."},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},scopedSlots:e._u([{key:"append",fn:function(){return[r("AppSimpleSelect",{attrs:{"remove-default-margin":"",name:"option","hide-default-option":"","value-prop":"value","label-prop":"name",options:e.selectOptions},model:{value:e.form.option,callback:function(t){e.$set(e.form,"option",t)},expression:"form.option"}}),r("AppButton",{attrs:{icon:e.icons.faSearch,outlined:""},on:{click:e.handleSearch}})]},proxy:!0}]),model:{value:e.form.search,callback:function(t){e.$set(e.form,"search",t)},expression:"form.search"}})],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:e.form.search,expression:"form.search"}],staticClass:"text-end"},[r("span",{staticClass:"clickable link-primary small",on:{click:e.clearSearch}},[e._v(" Limpar busca ")])])],1)},_=[],k=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("AppModal",e._g({attrs:{id:"clientModalNew",value:e.value,color:"success",centered:""},scopedSlots:e._u([{key:"title",fn:function(){return[r("FontAwesomeIcon",{staticClass:"me-1",attrs:{icon:e.icons.faUserPlus,"fixed-width":""}}),e._v("Novo cliente ")]},proxy:!0},{key:"body",fn:function(){return[e.value?r("ClientForm",{on:{success:e.onSuccess}}):e._e()]},proxy:!0}])},e.$listeners))],1)},A=[],E=r(2368),$={components:{ClientForm:E.Z},props:{value:{type:Boolean,default:!1}},data(){return{icons:{faUserPlus:n.FKd}}},methods:{onSuccess(){this.$emit("success")}}},N=$,P=(0,C.Z)(N,k,A,!1,null,null,null),T=P.exports,I={components:{ClientModalNew:T},data(){return{newClientModal:!1,form:{option:B.NAME,search:""},icons:{faUserPlus:n.FKd,faSearch:n.wn1}}},computed:{selectOptions(){return[{name:"Nome",value:B.NAME},{name:"Cidade",value:B.CITY},{name:"Telefone",value:B.PHONE}]}},methods:{onNewClientClick(){this.newClientModal=!0},onNewClientSuccess(){this.newClientModal=!1},getFormattedSearch(){return this.form.option===B.PHONE&&this.form.search.startsWith("(")?this.getSearchByDDD():`%${this.form.search}%`},getSearchByDDD(){const e=this.$helpers.stripNonDigits(this.form.search);return`${e}%`},getColumnOption(){return this.form.option===B.CITY?"NAME":this.form.option},getQueryToSearch(e){const t=this.form.option===B.CITY;return{hasCity:t?e:null,where:t?null:e}},handleSearch(){const e=this.getFormattedSearch(),t=this.getColumnOption(),r={value:e,operator:"LIKE",column:t},a=this.getQueryToSearch(r);this.$emit("search",a)},clearSearch(){this.form.search="",this.$emit("search-clear")}}},O=I,L=(0,C.Z)(O,S,_,!1,null,null,null),R=L.exports;const D={query:{},orderBy:[{column:"CREATED_AT",order:"DESC"}]},B={NAME:"NAME",CITY:"CITY",PHONE:"PHONE"};var M={components:{TheClientsCard:b,TheClientsHeader:R},metaInfo:{title:"Clientes"},apollo:{clients:{query:l.GetClients,variables(){return{...D,page:this.page}}}},data(){return{page:1,clientsParams:D,clients:{data:[],paginatorInfo:{}},icons:{faUserPlus:n.FKd}}},computed:{isLoading(){return!!this.$apollo.queries.clients.loading}},methods:{formatPhone:o.CN,onSearch(e){this.page=1,this.clientsParams.query={...this.clientsParams.query,...e}},onSearchClear(){this.page=1,this.clientsParams.query={hasCity:null,where:null}}}},Q=M,F=(0,C.Z)(Q,a,s,!1,null,null,null),Z=F.exports},1131:function(e,t,r){r.r(t),r.d(t,{default:function(){return E}});var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"py-5 mx-auto"},[r("div",[r("ClientOrdersHeader",{staticClass:"mb-3 mb-sm-0",on:{search:e.handleSearch,"clear-search":e.onSearchClear}})],1),r("div",{staticClass:"d-flex row flex-column flex-sm-row"},[r("div",{staticClass:"col col-sm-3 mb-2 mb-sm-0"},[r("ClientCard",{attrs:{"is-loading":e.isLoading,client:e.client}})],1),r("div",{staticClass:"col col-sm-9"},[r("ClientOrdersCard",{attrs:{"is-loading":e.isLoading,orders:e.orders.data}})],1),r("AppPaginator",{staticClass:"mt-2",attrs:{pagination:e.orders.paginatorInfo},model:{value:e.ordersQuery.page,callback:function(t){e.$set(e.ordersQuery,"page",t)},expression:"ordersQuery.page"}})],1)])},s=[],n=r(6486),o=r(1436),l=r(8299),i=r(2089),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("AppCard",{attrs:{"has-body-padding":!1,"is-loading":e.isLoading},scopedSlots:e._u([{key:"header",fn:function(){return[r("h6",{staticClass:"mb-0 fw-bold d-flex justify-content-between"},[r("div",[r("FontAwesomeIcon",{staticClass:"fa-fw fw-bold",attrs:{icon:e.icons.faBoxes}}),e._v(" Pedidos ")],1),r("OrdersQuestionIconTippy")],1)]},proxy:!0},{key:"body",fn:function(){return[r("AppTable",{attrs:{headers:e.headers,items:e.orders,"row-class":e.rowClass,route:e.tableRowRoute}})]},proxy:!0}])})},u=[],d=r(3221),p={components:{OrdersQuestionIconTippy:d.Z},props:{isLoading:{type:Boolean,default:!1},orders:{type:Array,default:()=>[]}},data(){return{icons:{faBoxes:o.G1z}}},computed:{headers(){return[{text:"Código",value:"code"},{text:"Valor total",value:"price",format:"currencyBRL"},{text:"Total pago",value:"total_paid",format:"currencyBRL"},{text:"Quantidade",value:"quantity",align:"center"},{text:"Data de produção",value:"production_date",align:"center",format:"datetime"},{text:"Data de entrega",value:"delivery_date",align:"center",format:"datetime"}]}},methods:{rowClass(e){return e.states.includes("PRE-REGISTERED")?"table-warning":e.states.includes("CLOSED")?"table-secondary":e.states.includes("PAID")?"table-success":""},tableRowRoute(e){return{name:"orders.show",params:this.$helpers.getRouteParams({client:this.$route.params.clientKey,order:e.id})}}}},m=p,h=r(1001),f=(0,h.Z)(m,c,u,!1,null,null,null),C=f.exports,y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"d-flex row flex-column flex-sm-row justify-content-between"},[r("div",{staticClass:"col-sm-3 mb-1"},[r("AppButton",{attrs:{outlined:""},on:{click:function(t){return e.$router.push({name:"clients.index"})}}},[r("FontAwesomeIcon",{attrs:{icon:e.icons.faArrowAltCircleLeft}}),e._v(" Clientes ")],1)],1),r("div",{staticClass:"col d-flex flex-column flex-sm-row justify-content-between"},[r("div",{staticClass:"col col-sm-2"},[r("AppButton",{staticClass:"mb-2 mb-sm-0",attrs:{"btn-class":"fw-bold w-100",color:"primary"},on:{click:function(t){return e.$helpers.redirectTo(e.orders.create,{client:e.$route.params.clientKey})}}},[r("FontAwesomeIcon",{staticClass:"mr-1",attrs:{icon:e.icons.faPlus}}),e._v(" Novo pedido ")],1)],1),r("div",{staticClass:"col col-sm-4"},[r("AppInput",{attrs:{"default-margin":!1,name:"code",placeholder:"Buscar por código..."},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},scopedSlots:e._u([{key:"append",fn:function(){return[r("AppButton",{attrs:{color:"primary",outlined:"",icon:e.icons.faSearch},on:{click:e.onSearch}})]},proxy:!0}]),model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)])]),r("div",{staticClass:"link-primary clickable small text-decoration-none d-flex justify-content-end mb-1",on:{click:function(t){return t.preventDefault(),e.clearSearch.apply(null,arguments)}}},[e._v(" "+e._s(""!==e.search?"Limpar busca":"")+" ")])])},v=[],g=r(5781),w={data(){return{orders:g.A6,search:"",icons:{faPlus:o.r8p,faSearch:o.wn1,faArrowAltCircleLeft:o.nP8}}},methods:{onSearch(){this.$emit("search",this.search)},clearSearch(){this.search="",this.$emit("clear-search")}}},x=w,b=(0,h.Z)(x,y,v,!1,null,null,null),S=b.exports,_={metaInfo(){return(0,n.isEmpty)(this.client)?{title:"Carregando..."}:{title:this.client.name}},components:{ClientCard:i.Z,ClientOrdersCard:C,ClientOrdersHeader:S},apollo:{client:{query:l.GetClientWithOrders,variables(){return{id:this.$route.params.clientKey,orderWhere:this.ordersQuery.where,orderPage:this.ordersQuery.page}},result({data:{client:e}}){e||this.$store.commit("SET_ERROR",404)}}},data(){return{ordersQuery:{where:{},page:1},client:null,icons:{faPlus:o.r8p}}},computed:{isLoading(){return!!this.$apollo.queries.client.loading},orders(){return this.client?.orders||{}}},methods:{handleSearch(e){const t={column:"CODE",operator:"LIKE",value:`%${e}%`};this.ordersQuery.page=1,this.ordersQuery.where=t},onSearchClear(){this.ordersQuery.page=1,this.ordersQuery.where={}}}},k=_,A=(0,h.Z)(k,a,s,!1,null,null,null),E=A.exports}}]);
//# sourceMappingURL=clients.6013c40f.js.map