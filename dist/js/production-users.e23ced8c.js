"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[421],{3664:function(o,s,e){e.r(s),e.d(s,{OPTIONS:function(){return q},default:function(){return Q}});var t=function(){var o=this,s=o.$createElement,e=o._self._c||s;return e("div",{staticClass:"py-5"},[e("TheProductionUsersCommission",{staticClass:"mb-2"}),e("TheProductionUsersCard",{attrs:{commissions:o.commissionsUsers.data,"is-loading":o.isLoading},on:{"tab-changed":o.onTabChanged}}),e("AppPaginator",{staticClass:"mt-2",attrs:{pagination:o.commissionsUsers.paginatorInfo,"is-loading":o.isLoading},model:{value:o.page,callback:function(s){o.page=s},expression:"page"}})],1)},i=[],a=e(2951),n=function(){var o=this,s=o.$createElement,e=o._self._c||s;return e("AppCard",{attrs:{collapsible:"",color:"success"},scopedSlots:o._u([{key:"header",fn:function(){return[e("h6",{staticClass:"fw-bold mb-0"},[e("FontAwesomeIcon",{attrs:{icon:o.icons.faCalendarAlt,"fixed-width":""}}),o._v(" Comissão mensal ")],1)]},proxy:!0},{key:"body",fn:function(){return[o.isEmpty(o.commissionByMonth)?o._e():e("div",[e("div",{staticClass:"text-center"},[o._v(" Comissão do mês "),e("span",{staticClass:"fw-bold"},[o._v(" "+o._s(o.commissionByMonth.month)+"/"+o._s(o.commissionByMonth.year)+" ")]),o._v(" para "),e("span",{staticClass:"fw-bold"},[o._v(o._s(o.commissionByMonth.role.name))])]),e("h5",{staticClass:"text-success text-center fw-bold"},[o._v(" "+o._s(o.$helpers.toBRL(o.commissionByMonth.value))+" ")])]),e("hr",{directives:[{name:"show",rawName:"v-show",value:!o.isEmpty(o.commissionByMonth),expression:"!isEmpty(commissionByMonth)"}]}),e("h6",{staticClass:"text-center text-secondary"},[o._v(" Selecione o mês para calcular a comissão ")]),e("AppForm",{attrs:{form:o.form,"on-submit":o.onSubmit}},[e("AppRadio",{attrs:{name:"role_id",options:o.radioProductionOptions,"label-prop":"text","value-prop":"id",error:o.form.errors.get("role_id")},model:{value:o.form.role_id,callback:function(s){o.$set(o.form,"role_id",s)},expression:"form.role_id"}},[o._v(" Tipo de usuário: ")]),e("AppInput",{attrs:{id:"month",type:"month",name:"month",mask:o.maskMonth,placeholder:"mm/aaaa",error:o.form.errors.get("month")},scopedSlots:o._u([{key:"hint",fn:function(){return[o._v(" O calculo é feito baseado na data em que as comissões foram confirmadas. ")]},proxy:!0}]),model:{value:o.form.month,callback:function(s){o.$set(o.form,"month",s)},expression:"form.month"}},[o._v(" Mês para calcular: ")]),e("div",{staticClass:"d-flex"},[e("AppButton",{attrs:{block:o.$isMobile,color:"success","btn-class":"fw-bold",loading:o.isLoading}},[o._v(" Calcular ")]),e("AppButton",{staticClass:"ms-2",attrs:{block:o.$isMobile,type:"button",color:"light"},on:{click:function(s){return s.preventDefault(),o.onClearClick.apply(null,arguments)}}},[o._v(" Limpar ")])],1)],1)]},proxy:!0}])})},r=[],l=e(2776),c=e(9697),m=e(1436),d=e(4082),u=e(1594),p=e(5539),f={data(){return{roles:l.Z,maskMonth:d.iS,isLoading:!1,commissionByMonth:{},form:new p.Z({role_id:"",month:""}),icons:{faCalendarAlt:m.IV4}}},computed:{radioProductionOptions(){return[{id:l.Z.COSTURA,text:"Costura"},{id:l.Z.ESTAMPA,text:"Estampa"}]}},methods:{isEmpty:c.Z,onClearClick(){this.form.reset(),this.commissionByMonth={}},async onSubmit(){const o=this.form.data();this.isLoading=!0;try{const{data:s}=await this.$apollo.query({query:a.GetMonthCommissionByRole,variables:{...o}});this.commissionByMonth=s.commissionRoleByMonth}catch(s){(0,u.S)(this,s)}this.isLoading=!1}}},h=f,v=e(1001),C=(0,v.Z)(h,n,r,!1,null,null,null),_=C.exports,y=function(){var o=this,s=o.$createElement,e=o._self._c||s;return e("AppCard",{scopedSlots:o._u([{key:"header",fn:function(){return[e("h6",{staticClass:"fw-bold mb-0"},[e("FontAwesomeIcon",{attrs:{icon:o.icons.faBox,"fixed-width":""}}),o._v(" Pedidos da produção ")],1)]},proxy:!0},{key:"body",fn:function(){return[e("AppLoading",{directives:[{name:"show",rawName:"v-show",value:o.isLoading,expression:"isLoading"}]}),e("ProductionUsersNavTab",{staticClass:"mt-2 mb-4",on:{change:o.onTabChange}}),e("TheProductionUsersCardTable",{attrs:{items:o.commissions}})]},proxy:!0}])})},b=[],x=function(){var o=this,s=o.$createElement,e=o._self._c||s;return e("div",[e("CommissionModal",{attrs:{commission:o.commissionModal.item},on:{hidden:o.onCommissionModalHidden},model:{value:o.commissionModal.value,callback:function(s){o.$set(o.commissionModal,"value",s)},expression:"commissionModal.value"}}),e("AppTable",{attrs:{"row-class":function(){return"align-middle"},headers:o.headers,items:o.items},scopedSlots:o._u([{key:"items.user",fn:function(s){var t=s.item;return[o._v(" "+o._s(t.user.name)+" "),e("div",[e("small",{staticClass:"text-secondary"},[o._v(" ("+o._s(t.role.name)+") ")])])]}},{key:"items.order",fn:function(s){var t=s.item;return[e("div",[e("a",{staticClass:"text-decoration-none fw-bold",attrs:{href:o.$helpers.getUrl(o.orders.show,{client:t.commission.order.client,order:t.commission.order}),target:"_blank"}},[o._v(o._s(t.commission.order.code))])]),e("small",{staticClass:"text-secondary"},[o._v(" (cadastro: "+o._s(o.formatDatetime(t.commission.order.created_at))+") ")])]}},{key:"items.commission_value",fn:function(s){var t=s.item;return[e("div",{staticClass:"d-flex"},[e("div",{staticClass:"col"},[o._v(" "+o._s(o.$helpers.toBRL(t.commission_value))+" ")]),e("div",{staticClass:"col ms-2 ms-sm-0"},[e("FontAwesomeIcon",{staticClass:"link-primary clickable",attrs:{name:"tippy__"+t.id,icon:o.icons.faExclamationCircle,"fixed-width":""},on:{click:function(s){return o.onCommissionInfoClick(s,t)}}}),e("Tippy",{attrs:{for:"tippy__"+t.id,"max-width":"500",theme:"light-border no-padding",trigger:"click",placement:"left",interactive:!0}},[e("CommissionDetails",{attrs:{commission:t.commission,role:t.role}})],1)],1)])]}},{key:"items.confirmed_at",fn:function(s){var t=s.item;return[t.confirmed_at?e("div",{staticClass:"fw-bold text-success"},[o._v(" "+o._s(o.formatDatetime(t.confirmed_at,"dd/MM 'às' HH:mm"))+" ")]):e("div",[e("div",{staticClass:"fw-bold text-warning"},[e("FontAwesomeIcon",{attrs:{icon:o.icons.faMinus}})],1),t.was_quantity_changed?e("div",{staticClass:"text-secondary"},[e("small",[o._v("(reaprovação necessária)")]),e("FontAwesomeIcon",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"text-primary",attrs:{"fixed-width":"",icon:o.icons.faQuestionCircle,content:"A produção confirmou o pedido, porém alterações foram feitas após isso, por isso é necessário ser reaprovado."}})],1):o._e()])]}}],null,!0)})],1)},g=[],w=e(7859),M=e(7309),k=e(5781),T=e(5321),A=e(7007),I={components:{Tippy:M.Jx,CommissionDetails:T.Z,CommissionModal:A.Z},props:{items:{type:Array,default:()=>[]}},data(){return{roles:l.Z,orders:k.A6,commissionModal:{item:{},value:!1},icons:{faMinus:m.Kl4,faQuestionCircle:m.sph,faExclamationCircle:m.RLE}}},computed:{headers(){return[{text:"Usuário",value:"user"},{text:"Pedido",value:"order"},{text:"Comissão",value:"commission_value",format:"currencyBRL"},{text:"Confirmação",value:"confirmed_at",align:"center"}]}},methods:{formatDatetime:w.DZ,onCommissionInfoClick(o,s){this.$isMobile&&+s.role.id!==l.Z.ESTAMPA&&(this.$isMobile&&+s.role.id===l.Z.COSTURA&&o.stopPropagation(),this.commissionModal.value=!0,this.commissionModal.item=s)},onCommissionModalHidden(){this.commissionModal.item={}},orderUrl(o,s){const e=this.$router.resolve({name:"orders.show",params:{clientKey:o,orderKey:s}});return e.href}}},N=I,O=(0,v.Z)(N,x,g,!1,null,null,null),P=O.exports,E=function(){var o=this,s=o.$createElement,e=o._self._c||s;return e("nav",{staticClass:"nav nav-pills flex-column flex-sm-row"},[e("a",{staticClass:"flex-sm-fill text-sm-center nav-link",class:{"active fw-bold":o.value===o.OPTIONS.ALL},attrs:{"aria-current":"page",href:"#"},on:{click:function(s){return s.preventDefault(),o.onTabClick(o.OPTIONS.ALL)}}},[o._v("TODOS")]),e("a",{staticClass:"flex-sm-fill text-sm-center nav-link",class:{"active fw-bold":o.value===o.OPTIONS.CONFIRMED},attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),o.onTabClick(o.OPTIONS.CONFIRMED)}}},[o._v("CONFIRMADOS")]),e("a",{staticClass:"flex-sm-fill text-sm-center nav-link",class:{"active fw-bold":o.value===o.OPTIONS.PENDING},attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),o.onTabClick(o.OPTIONS.PENDING)}}},[o._v("PENDENTES")])])},L=[],S={data(){return{value:q.ALL,OPTIONS:q}},methods:{onTabClick(o){o!==this.value&&(this.value=o,this.$emit("change",o))}}},B=S,D=(0,v.Z)(B,E,L,!1,null,null,null),U=D.exports,$={components:{TheProductionUsersCardTable:P,ProductionUsersNavTab:U},props:{commissions:{type:Array,default:()=>[]},isLoading:{type:Boolean,default:!1}},data(){return{icons:{faBox:m.hVM}}},methods:{onTabChange(o){this.$emit("tab-changed",o)}}},R=$,Z=(0,v.Z)(R,y,b,!1,null,null,null),F=Z.exports;const q={ALL:"all",CONFIRMED:"confirmed",PENDING:"pending"};var G={metaInfo:{title(){return"Produção"}},components:{TheProductionUsersCommission:_,TheProductionUsersCard:F},apollo:{commissionsUsers:{query:a.GetUsersCommissions,variables(){return{page:this.page,where:this.where,orderBy:this.orderBy}},fetchPolicy:"network-only"}},data(){return{page:1,where:{},orderBy:[],commissionsUsers:{data:[],paginatorInfo:{}}}},computed:{isLoading(){return!!this.$apollo.queries.commissionsUsers.loading}},methods:{onTabChanged(o){if(this.page=1,this.where={},this.orderBy=[],o===q.CONFIRMED)return this.where={column:"CONFIRMED_AT",operator:"IS_NOT_NULL"},void(this.orderBy=[{column:"CONFIRMED_AT",order:"DESC"}]);o===q.PENDING&&(this.where={column:"CONFIRMED_AT",operator:"IS_NULL"})}}},H=G,K=(0,v.Z)(H,t,i,!1,null,null,null),Q=K.exports}}]);
//# sourceMappingURL=production-users.e23ced8c.js.map