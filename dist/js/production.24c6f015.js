"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[630],{856:function(t,o,s){s.r(o),s.d(o,{default:function(){return V}});var e=function(){var t=this,o=t.$createElement,s=t._self._c||o;return s("div",{staticClass:"py-5"},[s("TheProductionCardCommission",{staticClass:"mb-2"}),s("TheProductionCard",{attrs:{"commissions-user":t.commissionsUser.data,"is-loading":t.isLoading}}),s("AppPaginator",{staticClass:"mt-2",attrs:{pagination:t.commissionsUser.paginatorInfo,"is-loading":t.isLoading},model:{value:t.page,callback:function(o){t.page=o},expression:"page"}})],1)},i=[],a=s(2951),n=function(){var t=this,o=t.$createElement,s=t._self._c||o;return s("AppCard",{attrs:{id:"productionCard"},scopedSlots:t._u([{key:"header",fn:function(){return[s("h6",{staticClass:"fw-bold mb-0"},[s("FontAwesomeIcon",{attrs:{icon:t.icons.faBox,"fixed-width":""}}),t._v(" Pedidos em produção ")],1)]},proxy:!0},{key:"body",fn:function(){return[s("AppLoading",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}]}),t.hasAnyOrderQuantityChanged?[s("div",{staticClass:"text-center"},[s("FontAwesomeIcon",{staticClass:"text-warning",attrs:{icon:t.icons.faExclamationTriangle,size:"3x"}})],1),s("div",{staticClass:"mb-3"},[s("h6",{staticClass:"text-center fw-bold mt-3 mb-0"},[t._v(" Alguns pedidos tiveram a sua quantidade alterada, por favor, verifique-os novamente. ")]),s("div",{staticClass:"text-secondary text-center text-subtitle"},[t._v(" (pedidos em amarelo) ")])])]:t._e(),s("TheProductionCardTable",{attrs:{items:t.commissionsUser}})]},proxy:!0}])})},r=[],c=s(2338),m=s(9823),l=s(820);function d(t,o){var s;return(0,l.Z)(t,(function(t,e,i){return s=o(t,e,i),!s})),!!s}var u=d,p=s(7771),f=s(439);function h(t,o,s){var e=(0,p.Z)(t)?c.Z:u;return s&&(0,f.Z)(t,o,s)&&(o=void 0),e(t,(0,m.Z)(o,3))}var v=h,C=s(1436),g=function(){var t=this,o=t.$createElement,s=t._self._c||o;return s("div",[s("CommissionModal",{attrs:{commission:t.commissionModal.item},model:{value:t.commissionModal.value,callback:function(o){t.$set(t.commissionModal,"value",o)},expression:"commissionModal.value"}}),s("AppTable",{attrs:{"row-class":t.rowClass,items:t.items,headers:t.headers},scopedSlots:t._u([{key:"items.code",fn:function(o){var s=o.item;return[t._v(" "+t._s(s.order.code)+" ")]}},{key:"items.quantity",fn:function(o){var s=o.item;return[t._v(" "+t._s(s.order.quantity)+" ")]}},{key:"items.commission",fn:function(o){var e=o.item;return[s("div",{staticClass:"d-flex"},[s("div",{staticClass:"col"},[t._v(" "+t._s(t.$helpers.toBRL(e.pivot.commission_value))+" ")]),s("div",{staticClass:"col-1 col-sm-6 me-3 me-sm-auto"},[s("FontAwesomeIcon",{staticClass:"link-primary clickable",attrs:{icon:t.icons.faExclamationCircle,name:"detailsTriggerFor"+e.id,"fixed-width":"",size:"lg"},on:{click:function(o){return t.onCommissionInfoClick(o,e)}}}),s("Tippy",{attrs:{theme:"no-padding light-border",trigger:"click",to:"detailsTriggerFor"+e.id,placement:"right","max-width":"500",interactive:!0}},[s("CommissionDetails",{attrs:{commission:e}})],1)],1)])]}},{key:"items.created_at",fn:function(o){var e=o.item;return[s("div",[t._v(t._s(t.formatDatetime(e.order.created_at,"dd/MM 'às' HH:mm")))]),e.pivot.was_quantity_changed?s("div",{staticClass:"small text-secondary"},[t._v(" (última alteração: "+t._s(t.formatDatetime(e.order.updated_at,"dd/MM 'às' HH:mm"))+") ")]):t._e()]}},{key:"items.image",fn:function(o){var e=o.item;return[s("AppButton",{attrs:{"btn-class":"btn-sm",outlined:"",icon:t.icons.faFileImage,tooltip:t.hasImages(e)?"Imagem do pedido":"Pedido sem imagens",color:t.hasImages(e)?"primary":"secondary",disabled:!t.hasImages(e)},on:{click:function(o){return o.preventDefault(),t.showImages(e)}}})]}},{key:"headers.confirmation",fn:function(){return[s("FontAwesomeIcon",{attrs:{icon:t.icons.faClipboardCheck,size:"lg"}})]},proxy:!0},{key:"items.confirmation",fn:function(o){var e=o.item;return[e.pivot.confirmed_at?[s("div",[s("FontAwesomeIcon",{staticClass:"text-success",attrs:{icon:t.icons.faCheck}})],1),s("div",{staticClass:"text-secondary small"},[t._v(" ("+t._s(t.formatDatetime(e.pivot.confirmed_at,"dd/MM 'às' HH:mm"))+") ")])]:[s("AppButton",{directives:[{name:"tippy",rawName:"v-tippy"}],attrs:{content:"Confirmar produção",color:"success",icon:t.icons.faCheck,"btn-class":"btn-sm",outlined:"",loading:t.loadingId===e.id},on:{click:function(o){return o.preventDefault(),t.confirmProduction(e)}}})]]}}],null,!0)})],1)},y=[],_=s(2776),b=s(7859),x=s(7309),k=s(5321),w=s(7007),M={components:{Tippy:x.Jx,CommissionDetails:k.Z,CommissionModal:w.Z},props:{items:{type:Array,default:()=>[]}},data(){return{loadingId:"",commissionModal:{value:!1,item:{}},icons:{faExclamationCircle:C.RLE,faClipboardCheck:C.E9T,faFileImage:C.Oi0,faCheck:C.LEp}}},computed:{headers(){return[{text:"Cód. Pedido",value:"code"},{text:"Peças",value:"quantity"},{text:"Comissão",value:"commission"},{text:"Cadastro em",value:"created_at",align:"center"},{text:"Imagem",value:"image",align:"center"},{text:"confirmation",value:"confirmation",align:"center"}]}},methods:{formatDatetime:b.DZ,onCommissionInfoClick(t,o){const{role:s}=o.pivot;this.$isMobile&&+s.id!==_.Z.ESTAMPA&&(this.$isMobile&&+s.id===_.Z.COSTURA&&t.stopPropagation(),this.commissionModal.item={commission:o,role:s},this.commissionModal.value=!0)},hasImages({order:{art_paths:t,size_paths:o}}){if(!t||!o)return!1;const s=[...t,...o];return!!s.length},showImages({order:{art_paths:t,size_paths:o}}){this.$viewerApi({images:[...t,...o]})},async confirmProduction({id:t}){this.loadingId=t;try{await this.$apollo.mutate({mutation:a.ConfirmCommissionProduction,variables:{id:t}}),this.$toast.success("Comissão confirmada!")}catch(o){this.$toast.error("Ops! Algo deu errado, tente novamente!")}this.loadingId=""},rowClass(t){const o=[];return t.pivot.was_quantity_changed&&o.push("table-warning"),t.pivot.confirmed_at&&o.push("table-success"),o.push("align-middle"),o.join(" ")}}},A=M,I=s(1001),B=(0,I.Z)(A,g,y,!1,null,null,null),Z=B.exports,P={components:{TheProductionCardTable:Z},props:{commissionsUser:{type:Array,default:()=>[]},isLoading:{type:Boolean,default:!1}},data(){return{icons:{faBox:C.hVM,faExclamationTriangle:C.eHv}}},computed:{hasAnyOrderQuantityChanged(){return v(this.commissionsUser,{pivot:{was_quantity_changed:!0}})}}},T=P,$=(0,I.Z)(T,n,r,!1,null,null,null),E=$.exports,L=function(){var t=this,o=t.$createElement,s=t._self._c||o;return s("AppCard",{attrs:{id:"productionCommissionCard",color:"success",collapsible:""},scopedSlots:t._u([{key:"header",fn:function(){return[s("h6",{staticClass:"fw-bold mb-0"},[s("FontAwesomeIcon",{attrs:{icon:t.icons.faCalendarAlt,"fixed-width":""}}),t._v(" Comissão mensal ")],1)]},proxy:!0},{key:"body",fn:function(){return[t.isEmpty(t.commissionByMonth)?t._e():s("div",[s("div",{staticClass:"text-center"},[t._v(" Comissão em "),s("b",[t._v(t._s(t.commissionByMonth.month)+"/"+t._s(t.commissionByMonth.year))])]),s("h5",{staticClass:"text-success text-center fw-bold"},[t._v(" "+t._s(t.$helpers.toBRL(t.commissionByMonth.value))+" ")])]),s("hr",{directives:[{name:"show",rawName:"v-show",value:!t.isEmpty(t.commissionByMonth),expression:"!isEmpty(commissionByMonth)"}]}),s("h6",{staticClass:"text-center fw-bold"},[t._v(" Selecione um mês para calcular a comissão ")]),s("div",[s("AppForm",{attrs:{form:t.form,"on-submit":t.onSubmit}},[s("AppInput",{attrs:{id:"month",type:"month",name:"month",placeholder:"mm/aaaa",mask:t.maskMonth,error:t.form.errors.get("month")},model:{value:t.form.month,callback:function(o){t.$set(t.form,"month",o)},expression:"form.month"}},[t._v(" Mês para calcular ")]),s("div",{staticClass:"d-flex"},[s("AppButton",{attrs:{block:t.$isMobile,color:"success","btn-class":"fw-bold",loading:t.isLoading}},[t._v(" Calcular ")]),s("AppButton",{staticClass:"ms-2",attrs:{block:t.$isMobile,type:"button",color:"light"},on:{click:function(o){return o.preventDefault(),t.onClearClick.apply(null,arguments)}}},[t._v(" Limpar ")])],1)],1)],1)]},proxy:!0}])})},q=[],F=s(6486),D=s(5539),S=s(1594),U=s(4082),H={data(){return{isLoading:!1,commissionByMonth:{},maskMonth:U.iS,form:new D.Z({month:""}),icons:{faCalendarAlt:C.IV4}}},methods:{isEmpty:F.isEmpty,onClearClick(){this.form.reset(),this.commissionByMonth={}},async onSubmit(){const t=this.form.data();this.isLoading=!0;try{const{data:o}=await this.$apollo.query({query:a.GetMonthCommissionByRole,variables:{...t}});this.commissionByMonth=o.commissionRoleByMonth}catch(o){(0,S.S)(this,o)}this.isLoading=!1}}},R=H,z=(0,I.Z)(R,L,q,!1,null,null,null),O=z.exports,N={metaInfo:{title(){return"Produção"}},apollo:{commissionsUser:{query:a.GetAuthUserCommissions,variables(){return{page:this.page}},fetchPolicy:"network-only"}},components:{TheProductionCard:E,TheProductionCardCommission:O},data(){return{page:1,commissionsUser:{data:[],paginatorInfo:{}}}},computed:{isLoading(){return!!this.$apollo.queries.commissionsUser.loading}}},G=N,Q=(0,I.Z)(G,e,i,!1,null,null,null),V=Q.exports},439:function(t,o,s){var e=s(9651),i=s(585),a=s(6009),n=s(7226);function r(t,o,s){if(!(0,n.Z)(s))return!1;var r=typeof o;return!!("number"==r?(0,i.Z)(s)&&(0,a.Z)(o,s.length):"string"==r&&o in s)&&(0,e.Z)(s[o],t)}o["Z"]=r}}]);
//# sourceMappingURL=production.24c6f015.js.map