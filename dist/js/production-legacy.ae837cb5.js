"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[630],{856:function(t,e,o){o.r(e),o.d(e,{default:function(){return K}});var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"py-5"},[o("TheProductionCardCommission",{staticClass:"mb-2"}),o("TheProductionCard",{attrs:{"commissions-user":t.commissionsUser.data,"is-loading":t.isLoading}}),o("AppPaginator",{staticClass:"mt-2",attrs:{pagination:t.commissionsUser.paginatorInfo,"is-loading":t.isLoading},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1)},i=[],s=o(2951),a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("AppCard",{attrs:{id:"productionCard"},scopedSlots:t._u([{key:"header",fn:function(){return[o("h6",{staticClass:"fw-bold mb-0"},[o("FontAwesomeIcon",{attrs:{icon:t.icons.faBox,"fixed-width":""}}),t._v(" Pedidos em produção ")],1)]},proxy:!0},{key:"body",fn:function(){return[o("AppLoading",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}]}),t.hasAnyOrderQuantityChanged?[o("div",{staticClass:"text-center"},[o("FontAwesomeIcon",{staticClass:"text-warning",attrs:{icon:t.icons.faExclamationTriangle,size:"3x"}})],1),o("div",{staticClass:"mb-3"},[o("h6",{staticClass:"text-center fw-bold mt-3 mb-0"},[t._v(" Alguns pedidos tiveram a sua quantidade alterada, por favor, verifique-os novamente. ")]),o("div",{staticClass:"text-secondary text-center text-subtitle"},[t._v(" (pedidos em amarelo) ")])])]:t._e(),o("TheProductionCardTable",{attrs:{items:t.commissionsUser}})]},proxy:!0}])})},r=[],c=o(2338),m=o(9823),l=o(820);function u(t,e){var o;return(0,l.Z)(t,(function(t,n,i){return o=e(t,n,i),!o})),!!o}var d=u,p=o(7771),f=o(439);function h(t,e,o){var n=(0,p.Z)(t)?c.Z:d;return o&&(0,f.Z)(t,e,o)&&(e=void 0),n(t,(0,m.Z)(e,3))}var v=h,g=o(1436),C=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("CommissionModal",{attrs:{commission:t.commissionModal.item},model:{value:t.commissionModal.value,callback:function(e){t.$set(t.commissionModal,"value",e)},expression:"commissionModal.value"}}),o("AppTable",{attrs:{"row-class":t.rowClass,items:t.items,headers:t.headers},scopedSlots:t._u([{key:"items.code",fn:function(e){var o=e.item;return[t._v(" "+t._s(o.order.code)+" ")]}},{key:"items.quantity",fn:function(e){var o=e.item;return[t._v(" "+t._s(o.order.quantity)+" ")]}},{key:"items.commission",fn:function(e){var n=e.item;return[o("div",{staticClass:"d-flex"},[o("div",{staticClass:"col"},[t._v(" "+t._s(t.$helpers.toBRL(n.pivot.commission_value))+" ")]),o("div",{staticClass:"col-1 col-sm-6 me-3 me-sm-auto"},[o("FontAwesomeIcon",{staticClass:"link-primary clickable",attrs:{icon:t.icons.faExclamationCircle,name:"detailsTriggerFor"+n.id,"fixed-width":"",size:"lg"},on:{click:function(e){return t.onCommissionInfoClick(e,n)}}}),o("Tippy",{attrs:{theme:"no-padding light-border",trigger:"click",to:"detailsTriggerFor"+n.id,placement:"right","max-width":"500",interactive:!0}},[o("CommissionDetails",{attrs:{commission:n}})],1)],1)])]}},{key:"items.created_at",fn:function(e){var n=e.item;return[o("div",[t._v(t._s(t.formatDatetime(n.order.created_at,"dd/MM 'às' HH:mm")))]),n.pivot.was_quantity_changed?o("div",{staticClass:"small text-secondary"},[t._v(" (última alteração: "+t._s(t.formatDatetime(n.order.updated_at,"dd/MM 'às' HH:mm"))+") ")]):t._e()]}},{key:"items.image",fn:function(e){var n=e.item;return[o("AppButton",{attrs:{"btn-class":"btn-sm",outlined:"",icon:t.icons.faFileImage,tooltip:t.hasImages(n)?"Imagem do pedido":"Pedido sem imagens",color:t.hasImages(n)?"primary":"secondary",disabled:!t.hasImages(n)},on:{click:function(e){return e.preventDefault(),t.showImages(n)}}})]}},{key:"headers.confirmation",fn:function(){return[o("FontAwesomeIcon",{attrs:{icon:t.icons.faClipboardCheck,size:"lg"}})]},proxy:!0},{key:"items.confirmation",fn:function(e){var n=e.item;return[n.pivot.confirmed_at?[o("div",[o("FontAwesomeIcon",{staticClass:"text-success",attrs:{icon:t.icons.faCheck}})],1),o("div",{staticClass:"text-secondary small"},[t._v(" ("+t._s(t.formatDatetime(n.pivot.confirmed_at,"dd/MM 'às' HH:mm"))+") ")])]:[o("AppButton",{directives:[{name:"tippy",rawName:"v-tippy"}],attrs:{content:"Confirmar produção",color:"success",icon:t.icons.faCheck,"btn-class":"btn-sm",outlined:"",loading:t.loadingId===n.id},on:{click:function(e){return e.preventDefault(),t.confirmProduction(n)}}})]]}}],null,!0)})],1)},y=[],_=o(6198),x=o(8932),b=(o(5666),o(2222),o(9600),o(2776)),k=o(7859),w=o(7309),M=o(5321),A=o(5687),I={components:{Tippy:w.Jx,CommissionDetails:M.Z,CommissionModal:A.Z},props:{items:{type:Array,default:function(){return[]}}},data:function(){return{loadingId:"",commissionModal:{value:!1,item:{}},icons:{faExclamationCircle:g.RLE,faClipboardCheck:g.E9T,faFileImage:g.Oi0,faCheck:g.LEp}}},computed:{headers:function(){return[{text:"Cód. Pedido",value:"code"},{text:"Peças",value:"quantity"},{text:"Comissão",value:"commission"},{text:"Cadastro em",value:"created_at",align:"center"},{text:"Imagem",value:"image",align:"center"},{text:"confirmation",value:"confirmation",align:"center"}]}},methods:{formatDatetime:k.DZ,onCommissionInfoClick:function(t,e){var o=e.pivot.role;this.$isMobile&&+o.id!==b.Z.ESTAMPA&&(this.$isMobile&&+o.id===b.Z.COSTURA&&t.stopPropagation(),this.commissionModal.item={commission:e,role:o},this.commissionModal.value=!0)},hasImages:function(t){var e=t.order,o=e.art_paths,n=e.size_paths;if(!o||!n)return!1;var i=[].concat((0,x.Z)(o),(0,x.Z)(n));return!!i.length},showImages:function(t){var e=t.order,o=e.art_paths,n=e.size_paths;this.$viewerApi({images:[].concat((0,x.Z)(o),(0,x.Z)(n))})},confirmProduction:function(t){var e=this;return(0,_.Z)(regeneratorRuntime.mark((function o(){var n;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=t.id,e.loadingId=n,o.prev=2,o.next=5,e.$apollo.mutate({mutation:s.ConfirmCommissionProduction,variables:{id:n}});case 5:e.$toast.success("Comissão confirmada!"),o.next=11;break;case 8:o.prev=8,o.t0=o["catch"](2),e.$toast.error("Ops! Algo deu errado, tente novamente!");case 11:e.loadingId="";case 12:case"end":return o.stop()}}),o,null,[[2,8]])})))()},rowClass:function(t){var e=[];return t.pivot.was_quantity_changed&&e.push("table-warning"),t.pivot.confirmed_at&&e.push("table-success"),e.push("align-middle"),e.join(" ")}}},Z=I,B=o(1001),P=(0,B.Z)(Z,C,y,!1,null,null,null),T=P.exports,$={components:{TheProductionCardTable:T},props:{commissionsUser:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1}},data:function(){return{icons:{faBox:g.hVM,faExclamationTriangle:g.eHv}}},computed:{hasAnyOrderQuantityChanged:function(){return v(this.commissionsUser,{pivot:{was_quantity_changed:!0}})}}},E=$,L=(0,B.Z)(E,a,r,!1,null,null,null),q=L.exports,F=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("AppCard",{attrs:{id:"productionCommissionCard",color:"success",collapsible:""},scopedSlots:t._u([{key:"header",fn:function(){return[o("h6",{staticClass:"fw-bold mb-0"},[o("FontAwesomeIcon",{attrs:{icon:t.icons.faCalendarAlt,"fixed-width":""}}),t._v(" Comissão mensal ")],1)]},proxy:!0},{key:"body",fn:function(){return[t.isEmpty(t.commissionByMonth)?t._e():o("div",[o("div",{staticClass:"text-center"},[t._v(" Comissão em "),o("b",[t._v(t._s(t.commissionByMonth.month)+"/"+t._s(t.commissionByMonth.year))])]),o("h5",{staticClass:"text-success text-center fw-bold"},[t._v(" "+t._s(t.$helpers.toBRL(t.commissionByMonth.value))+" ")])]),o("hr",{directives:[{name:"show",rawName:"v-show",value:!t.isEmpty(t.commissionByMonth),expression:"!isEmpty(commissionByMonth)"}]}),o("h6",{staticClass:"text-center fw-bold"},[t._v(" Selecione um mês para calcular a comissão ")]),o("div",[o("AppForm",{attrs:{form:t.form,"on-submit":t.onSubmit}},[o("AppInput",{attrs:{id:"month",type:"month",name:"month",placeholder:"mm/aaaa",mask:t.maskMonth,error:t.form.errors.get("month")},model:{value:t.form.month,callback:function(e){t.$set(t.form,"month",e)},expression:"form.month"}},[t._v(" Mês para calcular ")]),o("div",{staticClass:"d-flex"},[o("AppButton",{attrs:{block:t.$isMobile,color:"success","btn-class":"fw-bold",loading:t.isLoading}},[t._v(" Calcular ")]),o("AppButton",{staticClass:"ms-2",attrs:{block:t.$isMobile,type:"button",color:"light"},on:{click:function(e){return e.preventDefault(),t.onClearClick.apply(null,arguments)}}},[t._v(" Limpar ")])],1)],1)],1)]},proxy:!0}])})},D=[],R=o(4367),S=o(6486),U=o(5539),H=o(1594),z=o(4082),O={data:function(){return{isLoading:!1,commissionByMonth:{},maskMonth:z.iS,form:new U.Z({month:""}),icons:{faCalendarAlt:g.IV4}}},methods:{isEmpty:S.isEmpty,onClearClick:function(){this.form.reset(),this.commissionByMonth={}},onSubmit:function(){var t=this;return(0,_.Z)(regeneratorRuntime.mark((function e(){var o,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=t.form.data(),t.isLoading=!0,e.prev=2,e.next=5,t.$apollo.query({query:s.GetMonthCommissionByRole,variables:(0,R.Z)({},o)});case 5:n=e.sent,i=n.data,t.commissionByMonth=i.commissionRoleByMonth,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),(0,H.S)(t,e.t0);case 13:t.isLoading=!1;case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))()}}},N=O,G=(0,B.Z)(N,F,D,!1,null,null,null),Q=G.exports,V={metaInfo:{title:function(){return"Produção"}},apollo:{commissionsUser:{query:s.GetAuthUserCommissions,variables:function(){return{page:this.page}},fetchPolicy:"network-only"}},components:{TheProductionCard:q,TheProductionCardCommission:Q},data:function(){return{page:1,commissionsUser:{data:[],paginatorInfo:{}}}},computed:{isLoading:function(){return!!this.$apollo.queries.commissionsUser.loading}}},j=V,J=(0,B.Z)(j,n,i,!1,null,null,null),K=J.exports},439:function(t,e,o){var n=o(9651),i=o(585),s=o(6009),a=o(7226);function r(t,e,o){if(!(0,a.Z)(o))return!1;var r=typeof e;return!!("number"==r?(0,i.Z)(o)&&(0,s.Z)(e,o.length):"string"==r&&e in o)&&(0,n.Z)(o[e],t)}e["Z"]=r}}]);
//# sourceMappingURL=production-legacy.ae837cb5.js.map