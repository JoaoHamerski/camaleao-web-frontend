"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[30],{2339:function(e,t,n){n.r(t),n.d(t,{COLUMNS:function(){return B},clientsParams:function(){return M},default:function(){return q}});var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"col col-sm-10 mx-auto py-5"},[n("TheClientsHeader",{on:{search:e.onSearch,"search-clear":e.onSearchClear}}),n("TheClientsCard",{attrs:{clients:e.clients.data,"is-loading":e.isLoading}}),n("AppPaginator",{staticClass:"mt-2",attrs:{"is-loading":e.isLoading,pagination:e.clients.paginatorInfo},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)},a=[],o=n(4367),s=n(1436),i=n(7859),l=n(8299),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("AppCard",{staticClass:"mt-2",attrs:{"is-loading":e.isLoading,"has-body-padding":!1,color:"primary"},scopedSlots:e._u([{key:"header",fn:function(){return[n("h6",{staticClass:"fw-bold mb-0"},[n("FontAwesomeIcon",{staticClass:"me-1",attrs:{icon:e.icons.faUsers,"fixed-width":""}}),e._v(" Clientes ")],1)]},proxy:!0},{key:"body",fn:function(){return[n("TheClientsCardTable",{attrs:{items:e.clients}})]},proxy:!0}])})},u=[],d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("AppTable",{attrs:{headers:e.headers,items:e.items,route:e.tableRowRoute},scopedSlots:e._u([{key:"items.city.name",fn:function(t){var n=t.item;return[e._v(" "+e._s(e.get(n,"city.name","N/A"))+" "),n.city?[e._v(" - "+e._s(e.get(n,"city.state.abbreviation","N/A"))+" ")]:e._e()]}}],null,!0)})},p=[],f=n(6423),h=n(5781),m={props:{items:{type:Array,default:function(){return[]}}},computed:{headers:function(){return[{text:"Nome",value:"name"},{text:"Telefone",value:"phone",format:"phone"},{text:"Cidade",value:"city.name"}]}},methods:{get:f.Z,tableRowRoute:function(e){return{name:h.yj.show,params:this.$helpers.getRouteParams({client:e})}}}},C=m,y=n(1001),v=(0,y.Z)(C,d,p,!1,null,null,null),g=v.exports,w={components:{TheClientsCardTable:g},props:{clients:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1}},data:function(){return{icons:{faUsers:s.FVb}}}},b=w,x=(0,y.Z)(b,c,u,!1,null,null,null),S=x.exports,_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("ClientModalNew",{on:{success:e.onNewClientSuccess},model:{value:e.newClientModal,callback:function(t){e.newClientModal=t},expression:"newClientModal"}}),n("div",{staticClass:"d-flex flex-column flex-sm-row justify-content-between"},[n("AppButton",{staticClass:"fw-bold mb-3 mb-sm-0",attrs:{color:"success"},on:{click:function(t){return t.preventDefault(),e.onNewClientClick.apply(null,arguments)}}},[n("FontAwesomeIcon",{attrs:{"fixed-width":"",icon:e.icons.faUserPlus}}),e._v(" Novo cliente ")],1),n("div",{staticClass:"col-12 col-sm-5"},[n("AppInput",{attrs:{name:"search","default-margin":!1,placeholder:"Digite a busca..."},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},scopedSlots:e._u([{key:"append",fn:function(){return[n("AppSimpleSelect",{attrs:{"remove-default-margin":"",name:"option","hide-default-option":"","value-prop":"value","label-prop":"name",options:e.selectOptions},model:{value:e.form.option,callback:function(t){e.$set(e.form,"option",t)},expression:"form.option"}}),n("AppButton",{attrs:{icon:e.icons.faSearch,outlined:""},on:{click:e.handleSearch}})]},proxy:!0}]),model:{value:e.form.search,callback:function(t){e.$set(e.form,"search",t)},expression:"form.search"}})],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.form.search,expression:"form.search"}],staticClass:"text-end"},[n("span",{staticClass:"clickable link-primary small",on:{click:e.clearSearch}},[e._v(" Limpar busca ")])])],1)},k=[],A=(n(6755),n(4916),n(4765),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("AppModal",e._g({attrs:{id:"clientModalNew",value:e.value,color:"success",centered:""},scopedSlots:e._u([{key:"title",fn:function(){return[n("FontAwesomeIcon",{staticClass:"me-1",attrs:{icon:e.icons.faUserPlus,"fixed-width":""}}),e._v("Novo cliente ")]},proxy:!0},{key:"body",fn:function(){return[e.value?n("ClientForm",{on:{success:e.onSuccess}}):e._e()]},proxy:!0}])},e.$listeners))],1)}),E=[],$=n(2368),N={components:{ClientForm:$.Z},props:{value:{type:Boolean,default:!1}},data:function(){return{icons:{faUserPlus:s.FKd}}},methods:{onSuccess:function(){this.$emit("success")}}},P=N,T=(0,y.Z)(P,A,E,!1,null,null,null),I=T.exports,O={components:{ClientModalNew:I},data:function(){return{newClientModal:!1,form:{option:B.NAME,search:""},icons:{faUserPlus:s.FKd,faSearch:s.wn1}}},computed:{selectOptions:function(){return[{name:"Nome",value:B.NAME},{name:"Cidade",value:B.CITY},{name:"Telefone",value:B.PHONE}]}},methods:{onNewClientClick:function(){this.newClientModal=!0},onNewClientSuccess:function(){this.newClientModal=!1},getFormattedSearch:function(){return this.form.option===B.PHONE&&this.form.search.startsWith("(")?this.getSearchByDDD():"%".concat(this.form.search,"%")},getSearchByDDD:function(){var e=this.$helpers.stripNonDigits(this.form.search);return"".concat(e,"%")},getColumnOption:function(){return this.form.option===B.CITY?"NAME":this.form.option},getQueryToSearch:function(e){var t=this.form.option===B.CITY;return{hasCity:t?e:null,where:t?null:e}},handleSearch:function(){var e=this.getFormattedSearch(),t=this.getColumnOption(),n={value:e,operator:"LIKE",column:t},r=this.getQueryToSearch(n);this.$emit("search",r)},clearSearch:function(){this.form.search="",this.$emit("search-clear")}}},L=O,R=(0,y.Z)(L,_,k,!1,null,null,null),D=R.exports,M={query:{},orderBy:[{column:"CREATED_AT",order:"DESC"}]},B={NAME:"NAME",CITY:"CITY",PHONE:"PHONE"},Z={components:{TheClientsCard:S,TheClientsHeader:D},metaInfo:{title:"Clientes"},apollo:{clients:{query:l.GetClients,variables:function(){return(0,o.Z)((0,o.Z)({},M),{},{page:this.page})}}},data:function(){return{page:1,clientsParams:M,clients:{data:[],paginatorInfo:{}},icons:{faUserPlus:s.FKd}}},computed:{isLoading:function(){return!!this.$apollo.queries.clients.loading}},methods:{formatPhone:i.CN,onSearch:function(e){this.page=1,this.clientsParams.query=(0,o.Z)((0,o.Z)({},this.clientsParams.query),e)},onSearchClear:function(){this.page=1,this.clientsParams.query={hasCity:null,where:null}}}},Q=Z,F=(0,y.Z)(Q,r,a,!1,null,null,null),q=F.exports},1131:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"py-5 mx-auto"},[n("div",[n("ClientOrdersHeader",{staticClass:"mb-3 mb-sm-0",on:{search:e.handleSearch,"clear-search":e.onSearchClear}})],1),n("div",{staticClass:"d-flex row flex-column flex-sm-row"},[n("div",{staticClass:"col col-sm-3 mb-2 mb-sm-0"},[n("ClientCard",{attrs:{"is-loading":e.isLoading,client:e.client}})],1),n("div",{staticClass:"col col-sm-9"},[n("ClientOrdersCard",{attrs:{"is-loading":e.isLoading,orders:e.orders.data}})],1),n("AppPaginator",{staticClass:"mt-2",attrs:{pagination:e.orders.paginatorInfo},model:{value:e.ordersQuery.page,callback:function(t){e.$set(e.ordersQuery,"page",t)},expression:"ordersQuery.page"}})],1)])},a=[],o=(n(8309),n(6486)),s=n(1436),i=n(8299),l=n(2089),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("AppCard",{attrs:{"has-body-padding":!1,"is-loading":e.isLoading},scopedSlots:e._u([{key:"header",fn:function(){return[n("h6",{staticClass:"mb-0 fw-bold d-flex justify-content-between"},[n("div",[n("FontAwesomeIcon",{staticClass:"fa-fw fw-bold",attrs:{icon:e.icons.faBoxes}}),e._v(" Pedidos ")],1),n("OrdersQuestionIconTippy")],1)]},proxy:!0},{key:"body",fn:function(){return[n("AppTable",{attrs:{headers:e.headers,items:e.orders,"row-class":e.rowClass,route:e.tableRowRoute}})]},proxy:!0}])})},u=[],d=(n(6699),n(2023),n(3221)),p={components:{OrdersQuestionIconTippy:d.Z},props:{isLoading:{type:Boolean,default:!1},orders:{type:Array,default:function(){return[]}}},data:function(){return{icons:{faBoxes:s.G1z}}},computed:{headers:function(){return[{text:"Código",value:"code"},{text:"Valor total",value:"price",format:"currencyBRL"},{text:"Total pago",value:"total_paid",format:"currencyBRL"},{text:"Quantidade",value:"quantity",align:"center"},{text:"Data de produção",value:"production_date",align:"center",format:"datetime"},{text:"Data de entrega",value:"delivery_date",align:"center",format:"datetime"}]}},methods:{rowClass:function(e){return e.states.includes("PRE-REGISTERED")?"table-warning":e.states.includes("CLOSED")?"table-secondary":e.states.includes("PAID")?"table-success":""},tableRowRoute:function(e){return{name:"orders.show",params:this.$helpers.getRouteParams({client:this.$route.params.clientKey,order:e.id})}}}},f=p,h=n(1001),m=(0,h.Z)(f,c,u,!1,null,null,null),C=m.exports,y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"d-flex row flex-column flex-sm-row justify-content-between"},[n("div",{staticClass:"col-sm-3 mb-1"},[n("AppButton",{attrs:{outlined:""},on:{click:function(t){return e.$router.push({name:"clients.index"})}}},[n("FontAwesomeIcon",{attrs:{icon:e.icons.faArrowAltCircleLeft}}),e._v(" Clientes ")],1)],1),n("div",{staticClass:"col d-flex flex-column flex-sm-row justify-content-between"},[n("div",{staticClass:"col col-sm-2"},[n("AppButton",{staticClass:"mb-2 mb-sm-0",attrs:{"btn-class":"fw-bold w-100",color:"primary"},on:{click:function(t){return e.$helpers.redirectTo(e.orders.create,{client:e.$route.params.clientKey})}}},[n("FontAwesomeIcon",{staticClass:"mr-1",attrs:{icon:e.icons.faPlus}}),e._v(" Novo pedido ")],1)],1),n("div",{staticClass:"col col-sm-4"},[n("AppInput",{attrs:{"default-margin":!1,name:"code",placeholder:"Buscar por código..."},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},scopedSlots:e._u([{key:"append",fn:function(){return[n("AppButton",{attrs:{color:"primary",outlined:"",icon:e.icons.faSearch},on:{click:e.onSearch}})]},proxy:!0}]),model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)])]),n("div",{staticClass:"link-primary clickable small text-decoration-none d-flex justify-content-end mb-1",on:{click:function(t){return t.preventDefault(),e.clearSearch.apply(null,arguments)}}},[e._v(" "+e._s(""!==e.search?"Limpar busca":"")+" ")])])},v=[],g=(n(4916),n(4765),n(5781)),w={data:function(){return{orders:g.A6,search:"",icons:{faPlus:s.r8p,faSearch:s.wn1,faArrowAltCircleLeft:s.nP8}}},methods:{onSearch:function(){this.$emit("search",this.search)},clearSearch:function(){this.search="",this.$emit("clear-search")}}},b=w,x=(0,h.Z)(b,y,v,!1,null,null,null),S=x.exports,_={metaInfo:function(){return(0,o.isEmpty)(this.client)?{title:"Carregando..."}:{title:this.client.name}},components:{ClientCard:l.Z,ClientOrdersCard:C,ClientOrdersHeader:S},apollo:{client:{query:i.GetClientWithOrders,variables:function(){return{id:this.$route.params.clientKey,orderWhere:this.ordersQuery.where,orderPage:this.ordersQuery.page}},result:function(e){var t=e.data.client;t||this.$store.commit("SET_ERROR",404)}}},data:function(){return{ordersQuery:{where:{},page:1},client:null,icons:{faPlus:s.r8p}}},computed:{isLoading:function(){return!!this.$apollo.queries.client.loading},orders:function(){var e;return(null===(e=this.client)||void 0===e?void 0:e.orders)||{}}},methods:{handleSearch:function(e){var t={column:"CODE",operator:"LIKE",value:"%".concat(e,"%")};this.ordersQuery.page=1,this.ordersQuery.where=t},onSearchClear:function(){this.ordersQuery.page=1,this.ordersQuery.where={}}}},k=_,A=(0,h.Z)(k,r,a,!1,null,null,null),E=A.exports},6755:function(e,t,n){var r=n(2109),a=n(1702),o=n(1236).f,s=n(7466),i=n(1340),l=n(3929),c=n(4488),u=n(4964),d=n(1913),p=a("".startsWith),f=a("".slice),h=Math.min,m=u("startsWith"),C=!d&&!m&&!!function(){var e=o(String.prototype,"startsWith");return e&&!e.writable}();r({target:"String",proto:!0,forced:!C&&!m},{startsWith:function(e){var t=i(c(this));l(e);var n=s(h(arguments.length>1?arguments[1]:void 0,t.length)),r=i(e);return p?p(t,r,n):f(t,n,n+r.length)===r}})}}]);
//# sourceMappingURL=clients-legacy.4c5d1403.js.map