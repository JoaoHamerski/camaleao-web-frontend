"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[421],{3664:function(o,e,t){t.r(e),t.d(e,{OPTIONS:function(){return H},default:function(){return J}});var s=function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("div",{staticClass:"py-5"},[t("TheProductionUsersCommission",{staticClass:"mb-2"}),t("TheProductionUsersCard",{attrs:{commissions:o.commissionsUsers.data,"is-loading":o.isLoading},on:{"tab-changed":o.onTabChanged}}),t("AppPaginator",{staticClass:"mt-2",attrs:{pagination:o.commissionsUsers.paginatorInfo,"is-loading":o.isLoading},model:{value:o.page,callback:function(e){o.page=e},expression:"page"}})],1)},n=[],i=t(2951),a=function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("AppCard",{attrs:{collapsible:"",color:"success"},scopedSlots:o._u([{key:"header",fn:function(){return[t("h6",{staticClass:"fw-bold mb-0"},[t("FontAwesomeIcon",{attrs:{icon:o.icons.faCalendarAlt,"fixed-width":""}}),o._v(" Comissão mensal ")],1)]},proxy:!0},{key:"body",fn:function(){return[o.isEmpty(o.commissionByMonth)?o._e():t("div",[t("div",{staticClass:"text-center"},[o._v(" Comissão do mês "),t("span",{staticClass:"fw-bold"},[o._v(" "+o._s(o.commissionByMonth.month)+"/"+o._s(o.commissionByMonth.year)+" ")]),o._v(" para "),t("span",{staticClass:"fw-bold"},[o._v(o._s(o.commissionByMonth.role.name))])]),t("h5",{staticClass:"text-success text-center fw-bold"},[o._v(" "+o._s(o.$helpers.toBRL(o.commissionByMonth.value))+" ")])]),t("hr",{directives:[{name:"show",rawName:"v-show",value:!o.isEmpty(o.commissionByMonth),expression:"!isEmpty(commissionByMonth)"}]}),t("h6",{staticClass:"text-center text-secondary"},[o._v(" Selecione o mês para calcular a comissão ")]),t("AppForm",{attrs:{form:o.form,"on-submit":o.onSubmit}},[t("AppRadio",{attrs:{name:"role_id",options:o.radioProductionOptions,"label-prop":"text","value-prop":"id",error:o.form.errors.get("role_id")},model:{value:o.form.role_id,callback:function(e){o.$set(o.form,"role_id",e)},expression:"form.role_id"}},[o._v(" Tipo de usuário: ")]),t("AppInput",{attrs:{id:"month",type:"month",name:"month",mask:o.maskMonth,placeholder:"mm/aaaa",error:o.form.errors.get("month")},scopedSlots:o._u([{key:"hint",fn:function(){return[o._v(" O calculo é feito baseado na data em que as comissões foram confirmadas. ")]},proxy:!0}]),model:{value:o.form.month,callback:function(e){o.$set(o.form,"month",e)},expression:"form.month"}},[o._v(" Mês para calcular: ")]),t("div",{staticClass:"d-flex"},[t("AppButton",{attrs:{block:o.$isMobile,color:"success","btn-class":"fw-bold",loading:o.isLoading}},[o._v(" Calcular ")]),t("AppButton",{staticClass:"ms-2",attrs:{block:o.$isMobile,type:"button",color:"light"},on:{click:function(e){return e.preventDefault(),o.onClearClick.apply(null,arguments)}}},[o._v(" Limpar ")])],1)],1)]},proxy:!0}])})},r=[],l=t(4367),c=t(6198),m=(t(5666),t(2776)),d=t(9697),u=t(1436),f=t(4082),p=t(1594),h=t(5539),v={data:function(){return{roles:m.Z,maskMonth:f.iS,isLoading:!1,commissionByMonth:{},form:new h.Z({role_id:"",month:""}),icons:{faCalendarAlt:u.IV4}}},computed:{radioProductionOptions:function(){return[{id:m.Z.COSTURA,text:"Costura"},{id:m.Z.ESTAMPA,text:"Estampa"}]}},methods:{isEmpty:d.Z,onClearClick:function(){this.form.reset(),this.commissionByMonth={}},onSubmit:function(){var o=this;return(0,c.Z)(regeneratorRuntime.mark((function e(){var t,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=o.form.data(),o.isLoading=!0,e.prev=2,e.next=5,o.$apollo.query({query:i.GetMonthCommissionByRole,variables:(0,l.Z)({},t)});case 5:s=e.sent,n=s.data,o.commissionByMonth=n.commissionRoleByMonth,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),(0,p.S)(o,e.t0);case 13:o.isLoading=!1;case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))()}}},C=v,_=t(1001),y=(0,_.Z)(C,a,r,!1,null,null,null),b=y.exports,x=function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("AppCard",{scopedSlots:o._u([{key:"header",fn:function(){return[t("h6",{staticClass:"fw-bold mb-0"},[t("FontAwesomeIcon",{attrs:{icon:o.icons.faBox,"fixed-width":""}}),o._v(" Pedidos da produção ")],1)]},proxy:!0},{key:"body",fn:function(){return[t("AppLoading",{directives:[{name:"show",rawName:"v-show",value:o.isLoading,expression:"isLoading"}]}),t("ProductionUsersNavTab",{staticClass:"mt-2 mb-4",on:{change:o.onTabChange}}),t("TheProductionUsersCardTable",{attrs:{items:o.commissions}})]},proxy:!0}])})},g=[],w=function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("div",[t("CommissionModal",{attrs:{commission:o.commissionModal.item},on:{hidden:o.onCommissionModalHidden},model:{value:o.commissionModal.value,callback:function(e){o.$set(o.commissionModal,"value",e)},expression:"commissionModal.value"}}),t("AppTable",{attrs:{"row-class":function(){return"align-middle"},headers:o.headers,items:o.items},scopedSlots:o._u([{key:"items.user",fn:function(e){var s=e.item;return[o._v(" "+o._s(s.user.name)+" "),t("div",[t("small",{staticClass:"text-secondary"},[o._v(" ("+o._s(s.role.name)+") ")])])]}},{key:"items.order",fn:function(e){var s=e.item;return[t("div",[t("a",{staticClass:"text-decoration-none fw-bold",attrs:{href:o.$helpers.getUrl(o.orders.show,{client:s.commission.order.client,order:s.commission.order}),target:"_blank"}},[o._v(o._s(s.commission.order.code))])]),t("small",{staticClass:"text-secondary"},[o._v(" (cadastro: "+o._s(o.formatDatetime(s.commission.order.created_at))+") ")])]}},{key:"items.commission_value",fn:function(e){var s=e.item;return[t("div",{staticClass:"d-flex"},[t("div",{staticClass:"col"},[o._v(" "+o._s(o.$helpers.toBRL(s.commission_value))+" ")]),t("div",{staticClass:"col ms-2 ms-sm-0"},[t("FontAwesomeIcon",{staticClass:"link-primary clickable",attrs:{name:"tippy__"+s.id,icon:o.icons.faExclamationCircle,"fixed-width":""},on:{click:function(e){return o.onCommissionInfoClick(e,s)}}}),t("Tippy",{attrs:{for:"tippy__"+s.id,"max-width":"500",theme:"light-border no-padding",trigger:"click",placement:"left",interactive:!0}},[t("CommissionDetails",{attrs:{commission:s.commission,role:s.role}})],1)],1)])]}},{key:"items.confirmed_at",fn:function(e){var s=e.item;return[s.confirmed_at?t("div",{staticClass:"fw-bold text-success"},[o._v(" "+o._s(o.formatDatetime(s.confirmed_at,"dd/MM 'às' HH:mm"))+" ")]):t("div",[t("div",{staticClass:"fw-bold text-warning"},[t("FontAwesomeIcon",{attrs:{icon:o.icons.faMinus}})],1),s.was_quantity_changed?t("div",{staticClass:"text-secondary"},[t("small",[o._v("(reaprovação necessária)")]),t("FontAwesomeIcon",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"text-primary",attrs:{"fixed-width":"",icon:o.icons.faQuestionCircle,content:"A produção confirmou o pedido, porém alterações foram feitas após isso, por isso é necessário ser reaprovado."}})],1):o._e()])]}}],null,!0)})],1)},M=[],k=t(7859),T=t(7309),A=t(5781),I=t(5321),N=t(5687),O={components:{Tippy:T.Jx,CommissionDetails:I.Z,CommissionModal:N.Z},props:{items:{type:Array,default:function(){return[]}}},data:function(){return{roles:m.Z,orders:A.A6,commissionModal:{item:{},value:!1},icons:{faMinus:u.Kl4,faQuestionCircle:u.sph,faExclamationCircle:u.RLE}}},computed:{headers:function(){return[{text:"Usuário",value:"user"},{text:"Pedido",value:"order"},{text:"Comissão",value:"commission_value",format:"currencyBRL"},{text:"Confirmação",value:"confirmed_at",align:"center"}]}},methods:{formatDatetime:k.DZ,onCommissionInfoClick:function(o,e){this.$isMobile&&+e.role.id!==m.Z.ESTAMPA&&(this.$isMobile&&+e.role.id===m.Z.COSTURA&&o.stopPropagation(),this.commissionModal.value=!0,this.commissionModal.item=e)},onCommissionModalHidden:function(){this.commissionModal.item={}},orderUrl:function(o,e){var t=this.$router.resolve({name:"orders.show",params:{clientKey:o,orderKey:e}});return t.href}}},P=O,E=(0,_.Z)(P,w,M,!1,null,null,null),L=E.exports,S=function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("nav",{staticClass:"nav nav-pills flex-column flex-sm-row"},[t("a",{staticClass:"flex-sm-fill text-sm-center nav-link",class:{"active fw-bold":o.value===o.OPTIONS.ALL},attrs:{"aria-current":"page",href:"#"},on:{click:function(e){return e.preventDefault(),o.onTabClick(o.OPTIONS.ALL)}}},[o._v("TODOS")]),t("a",{staticClass:"flex-sm-fill text-sm-center nav-link",class:{"active fw-bold":o.value===o.OPTIONS.CONFIRMED},attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),o.onTabClick(o.OPTIONS.CONFIRMED)}}},[o._v("CONFIRMADOS")]),t("a",{staticClass:"flex-sm-fill text-sm-center nav-link",class:{"active fw-bold":o.value===o.OPTIONS.PENDING},attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),o.onTabClick(o.OPTIONS.PENDING)}}},[o._v("PENDENTES")])])},B=[],D={data:function(){return{value:H.ALL,OPTIONS:H}},methods:{onTabClick:function(o){o!==this.value&&(this.value=o,this.$emit("change",o))}}},U=D,$=(0,_.Z)(U,S,B,!1,null,null,null),R=$.exports,Z={components:{TheProductionUsersCardTable:L,ProductionUsersNavTab:R},props:{commissions:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1}},data:function(){return{icons:{faBox:u.hVM}}},methods:{onTabChange:function(o){this.$emit("tab-changed",o)}}},F=Z,q=(0,_.Z)(F,x,g,!1,null,null,null),G=q.exports,H={ALL:"all",CONFIRMED:"confirmed",PENDING:"pending"},K={metaInfo:{title:function(){return"Produção"}},components:{TheProductionUsersCommission:b,TheProductionUsersCard:G},apollo:{commissionsUsers:{query:i.GetUsersCommissions,variables:function(){return{page:this.page,where:this.where,orderBy:this.orderBy}},fetchPolicy:"network-only"}},data:function(){return{page:1,where:{},orderBy:[],commissionsUsers:{data:[],paginatorInfo:{}}}},computed:{isLoading:function(){return!!this.$apollo.queries.commissionsUsers.loading}},methods:{onTabChanged:function(o){if(this.page=1,this.where={},this.orderBy=[],o===H.CONFIRMED)return this.where={column:"CONFIRMED_AT",operator:"IS_NOT_NULL"},void(this.orderBy=[{column:"CONFIRMED_AT",order:"DESC"}]);o===H.PENDING&&(this.where={column:"CONFIRMED_AT",operator:"IS_NULL"})}}},Q=K,V=(0,_.Z)(Q,s,n,!1,null,null,null),J=V.exports}}]);
//# sourceMappingURL=production-users-legacy.88322ce6.js.map